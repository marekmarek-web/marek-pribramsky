<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Hypotéka bez kontaktu | Kalkulačka hypoték a úvěrů 2025</title>
    
    <!-- 1. KROK: Styly a knihovny -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="../assets/img/logos/pb-logo-no-bg.png">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            50: '#f8fafc',
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        brand: {
                            navy: '#1D2354',
                            navyLight: '#2a3366',
                            dark: '#0a0f29',
                            cyan: '#4FC6F2',
                            gold: '#fbbf24',
                            lightgold: '#fde047',
                            main: '#1D2354',
                            light: '#EAF3FF',
                            border: '#D6E6FF',
                            background: '#F8FAFC',
                            text: '#0F172A',
                            muted: '#475569',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    keyframes: {
                        scroll: {
                            '0%': { transform: 'translateX(0)' },
                            '100%': { transform: 'translateX(-50%)' },
                        },
                        shimmer: {
                            '0%': { transform: 'skewX(-20deg) translateX(-150%)' },
                            '100%': { transform: 'skewX(-20deg) translateX(150%)' }
                        }
                    },
                    animation: {
                        scroll: 'scroll 40s linear infinite',
                        shimmer: 'shimmer 2.5s infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* Globální styly */
        :root { font-family: 'Inter', sans-serif; }
        
        /* Zabránění horizontálnímu posuvu */
        body { overflow-x: hidden; }
    
        /* Horní header (tmavý na začátku) */
        .glass-header-top {
            background-color: #0a0f29;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
    
        /* Scrolled header (světlý při posunu) */
        .glass-header-scrolled {
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(11, 58, 122, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        }
    
        /* Styl navigačních odkazů */
        .nav-link {
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            padding: 0.6rem 1rem;
            border-radius: 9999px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
        }
    
        /* Mobilní menu pomocné třídy */
        .mobile-menu-active { display: flex; }
        .mobile-menu-inactive { display: none; }

        /* Styly pro kalkulačku */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #4FC6F2; border: 3px solid #fff; cursor: pointer; margin-top: -10px; box-shadow: 0 4px 6px rgba(79, 198, 242, 0.4); transition: transform 0.1s; }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 6px; cursor: pointer; background: #e2e8f0; border-radius: 3px; }
        input[type=range]:focus { outline: none; }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .bank-logo { max-width: 100px; max-height: 30px; object-fit: contain; object-position: left center; }
        /* Nekonečný logo wheel – 2 sady, -50% = seamless loop */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .animate-scroll {
            width: max-content;
            display: flex;
            flex-wrap: nowrap;
            align-items: center;
            will-change: transform;
            animation: scroll 50s linear infinite;
        }
        .partner-logo {
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 70px;
            margin: 0 48px;
        }
        .partner-logo img {
            max-height: 50px;
            max-width: 140px;
            width: auto;
            object-fit: contain;
            filter: grayscale(100%);
            opacity: 0.8;
            transition: filter 0.3s ease, opacity 0.3s ease;
        }
        .partner-logo:hover img { filter: grayscale(0%); opacity: 1; }

        @media (max-width: 768px) {
            .animate-scroll { animation-duration: 35s; }
            .partner-logo { margin: 0 24px; height: 56px; }
            .partner-logo img { max-height: 40px; max-width: 100px; }
        }
        
        .review-badge { transition: transform 0.2s, box-shadow 0.2s; }
        .review-badge:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        
        .trophy-badge { position: relative; overflow: hidden; }
        .trophy-icon { position: absolute; right: -2px; bottom: -2px; font-size: 2.5rem; color: #4FC6F2; opacity: 0.1; pointer-events: none; }
        
        .disabled-btn { opacity: 0.5; cursor: not-allowed; background-color: #e2e8f0 !important; color: #94a3b8 !important; pointer-events: none; }
        
        @media (max-width: 1023px) {
            #mobile-result-container { position: fixed; bottom: 0; left: 0; width: 100%; z-index: 40; padding: 1rem; background-color: transparent; pointer-events: none; transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out; opacity: 1; }
            #mobile-result-container.hidden-mobile-float { transform: translateY(150%); opacity: 0; }
            #mobile-result-card { pointer-events: auto; margin: 0 auto; max-width: 450px; box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.15); }
            #hypo-srovnavac { padding-bottom: 40px !important; }
        }
        .lead-cta-btn {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            border: 1px solid rgba(22, 163, 74, 0.45);
            box-shadow: 0 10px 24px rgba(22, 163, 74, 0.28), inset 0 1px 0 rgba(255,255,255,0.28);
        }
        .lead-cta-btn:hover:not(:disabled) {
            filter: brightness(1.04);
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%) !important;
        }
        .lead-cta-btn:disabled { opacity: 0.75; cursor: not-allowed; }
        .neu-raised {
            background: linear-gradient(145deg, #ffffff, #F3F7FF);
            box-shadow: 10px 10px 20px rgba(29, 35, 84, .14), -10px -10px 20px rgba(255,255,255,.95);
            border: 1px solid rgba(214, 230, 255, .85);
        }
        .neu-flat { background: linear-gradient(145deg, #ffffff, #F3F7FF); }
        .neu-inset {
            background: linear-gradient(145deg, #F3F7FF, #ffffff);
            box-shadow: inset 6px 6px 12px rgba(29, 35, 84, .12), inset -6px -6px 12px rgba(255,255,255,.9);
            border: 1px solid rgba(214, 230, 255, .9);
        }
        .neu-focus:focus { outline: none; }
        .neu-focus:focus-visible { outline: 2px solid #1D2354; outline-offset: 2px; }
    </style>
</head>
<body class="bg-brand-light font-sans text-slate-800 page-loaded">

<!-- --- HEADER PB (Marek Příbramský) --- -->
  <header id="main-header" class="header-entry fixed top-0 left-0 right-0 z-50 transform -translate-y-full transition-transform duration-500 ease-out" role="banner">
  <div class="header-inner max-w-6xl mx-auto px-4 pt-4 pb-2">
    <div class="header-glass rounded-full border border-slate-300/60 shadow-sm px-3 py-2 flex justify-between items-center gap-3">
      <a href="https://www.marekpribramsky.cz/" class="flex items-center gap-2 rounded-full bg-white/80 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-white/90 transition-colors focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1 shrink-0" aria-label="Úvodní stránka">
        <img src="../assets/img/logos/pb-logo-no-bg.png" alt="Premium Brokers" class="h-8 w-auto" />
      </a>
      <button id="mobile-menu-btn" type="button" class="hamburger-btn md:hidden flex items-center justify-center w-11 h-11 rounded-full text-slate-700 hover:bg-slate-100 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40" aria-label="Otevřít menu" aria-expanded="false" aria-controls="mobile-menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
      <nav id="mobile-menu" class="mobile-nav-drawer fixed inset-0 z-40 md:hidden" aria-label="Mobilní navigace" aria-hidden="true">
        <div class="mobile-nav-backdrop absolute inset-0 bg-black/40 backdrop-blur-sm" data-close-menu aria-hidden="true"></div>
        <div class="mobile-nav-panel absolute top-0 right-0 w-full max-w-sm h-full bg-white shadow-2xl flex flex-col pt-20 px-6 pb-8">
          <a href="https://www.marekpribramsky.cz/#proc-ja" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">O mně</a>
          <a href="https://www.marekpribramsky.cz/#sluzby" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Služby</a>
          <a href="https://www.marekpribramsky.cz/#spoluprace" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Spolupráce</a>
          <a href="https://www.marekpribramsky.cz/kalkulacky" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Kalkulačky</a>
          <a href="https://www.marekpribramsky.cz/blog" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Blog</a>
          <a href="https://www.marekpribramsky.cz/kontakt" class="mobile-nav-link mt-4 py-4 rounded-xl bg-[#1D2354] text-white font-semibold text-center">Kontaktujte mě</a>
        </div>
      </nav>
      <nav class="hidden md:flex items-center gap-1" aria-label="Hlavní navigace">
        <a href="https://www.marekpribramsky.cz/#proc-ja" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">O mně</a>
        <a href="https://www.marekpribramsky.cz/#sluzby" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Služby</a>
        <a href="https://www.marekpribramsky.cz/#spoluprace" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Spolupráce</a>
        <div class="relative group" aria-haspopup="true">
          <button type="button" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">
            Nástroje
            <svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 w-72 rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-xl shadow-lg p-2 invisible opacity-0 translate-y-1 group-hover:visible group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-200 z-50">
            <a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Hypoteční kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Měsíční splátka a náklady</span></a>
            <a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Investiční kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Projekce zhodnocení</span></a>
            <a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Kalkulačka životního pojištění</span><span class="block text-xs text-slate-500 mt-0.5">Potřebné krytí</span></a>
            <a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Penzijní kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Státní příspěvky</span></a>
            <div class="border-t border-slate-100 mt-2 pt-2"><a href="https://www.marekpribramsky.cz/kalkulacky" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition font-semibold text-[#1D2354]">Všechny kalkulačky →</a></div>
          </div>
        </div>
        <a href="https://www.marekpribramsky.cz/blog" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Blog</a>
      </nav>
      <a href="https://www.marekpribramsky.cz/kontakt" class="header-cta flex items-center justify-center gap-2 rounded-full bg-[#1D2354] text-white px-4 py-2 text-sm font-semibold hover:opacity-95 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1 shrink-0">
        <span>Kontaktujte mě</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 17L17 7M17 7H7M17 7v10"/></svg>
      </a>
    </div>
  </div>
</header>
<!-- --- HEADER KONEC --- -->

    <!-- Hlavní obsah (sekce kalkulačky) -->
    <main class="main-with-header">
        <section id="hypo-srovnavac" class="bg-brand-light py-10 px-4 md:py-20 container-padding">
            <div class="max-w-7xl mx-auto">

                <!-- HLAVIČKA KALKULAČKY – pozadí jako stránka (světle modrá), fixní rozměry -->
                <div class="hero-banner-calc bg-brand-light rounded-3xl p-8 md:p-12 mb-10 shadow-xl border border-brand-border/60 relative overflow-hidden">
                    <div class="absolute inset-0 overflow-hidden rounded-3xl pointer-events-none select-none">
                        <img src="../assets/img/logos/pb-logo-no-bg.png" alt="" aria-hidden="true"
                            class="absolute -bottom-24 -right-24 w-[32rem] max-w-[58%] h-auto opacity-20">
                    </div>
                    <div class="relative z-10 flex flex-col lg:flex-row justify-between items-start gap-8">
                        
                        <!-- Textová část -->
                        <div class="flex-1">
                            <h2 class="text-3xl md:text-5xl font-extrabold mb-4 leading-tight text-brand-navy">
                                Kalkulačka hypoték a úvěrů<br>
                                <span class="text-brand-navy">Srovnání bez kontaktu</span>
                            </h2>
                            <p id="mainDesc" class="text-slate-600 text-lg mb-8 max-w-2xl leading-relaxed">
                                <strong class="text-brand-navy">Hypotéka bez telefonního čísla</strong> a nutnosti registrace. 
                                Spočítejte si splátku pro nové bydlení, auto či konsolidaci úvěrů. 
                                Přesně, rychle a zcela anonymně.
                            </p>

                            <!-- MAIN PRODUCT SWITCH -->
                            <div class="flex flex-col gap-4">
                                <!-- Product Type Switcher -->
                                <div class="inline-flex bg-white/80 p-1 rounded-xl border border-brand-border w-fit mb-2">
                                    <button class="prod-switch active px-6 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 bg-white text-brand-navy shadow-md border border-brand-border" data-prod="mortgage" onclick="switchProduct('mortgage')">
                                        <i class="fas fa-home mr-2"></i>Hypotéka
                                    </button>
                                    <button class="prod-switch px-6 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 text-slate-600 hover:bg-white hover:text-brand-navy" data-prod="loan" onclick="switchProduct('loan')">
                                        <i class="fas fa-hand-holding-usd mr-2"></i>Úvěry
                                    </button>
                                </div>

                                <!-- Common Tabs (New/Refi) -->
                                <div id="subTabs" class="inline-flex bg-white/60 p-1.5 rounded-xl border border-brand-border w-fit transition-all duration-300">
                                    <button class="hx-tab active px-8 py-3 rounded-lg text-sm font-bold transition-all duration-200 bg-white text-brand-navy shadow-md border border-brand-border" data-tab="new" onclick="switchTab('new')">
                                        <span id="tabNewText">Nová hypotéka</span>
                                    </button>
                                    <button class="hx-tab px-8 py-3 rounded-lg text-sm font-bold transition-all duration-200 text-slate-600 hover:bg-white hover:text-brand-navy" data-tab="refi" onclick="switchTab('refi')">
                                        Refinancování
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Google – jediný badge (odkaz na vyhledávání Premium Brokers) -->
                        <div class="flex flex-col gap-3 min-w-[240px]">
                            <a href="https://www.google.com/search?q=premium+brokers+roudnice" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            class="review-badge bg-white rounded-xl py-3 px-4 shadow-lg flex items-center gap-4 group no-underline text-slate-800">
                                <div class="bg-white p-1.5 rounded-full border border-slate-100 shrink-0">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg" alt="Google" class="w-5 h-5">
                                </div>
                                <div>
                                    <div class="flex items-center gap-1.5 mb-0.5">
                                        <span class="font-bold text-lg">4,9</span>
                                        <div class="flex text-yellow-400 text-xs" aria-hidden="true">
                                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        </div>
                                        <span class="text-xs text-slate-400">(45)</span>
                                    </div>
                                    <div class="text-xs font-semibold text-slate-500 group-hover:text-brand-navy transition-colors">
                                        Zobrazit recenze
                                    </div>
                                </div>
                            </a>
                        </div>

                    </div>
                </div>

                <!-- GRID ROZLOŽENÍ -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">

                    <!-- LEVÁ ČÁST: VSTUPY (7 columns) -->
                    <div class="lg:col-span-7 space-y-6">
                        
                        <!-- Karta vstupů -->
                        <div class="bg-white rounded-2xl p-6 md:p-10 shadow-sm border border-brand-border/60">
                            
                            <!-- Product Sub-Type Buttons -->
                            <div class="mb-8">
                                <label class="block text-sm font-bold text-slate-600 mb-3 uppercase tracking-wide">Typ produktu</label>
                                
                                <!-- Buttons Container -->
                                <div id="subTypeContainer" class="flex flex-wrap gap-3">
                                    <!-- JS injected buttons will go here -->
                                </div>
                                
                                <!-- Dynamic Info Text -->
                                <div id="subTypeInfoBox" class="mt-4 bg-blue-50 border border-blue-100 rounded-xl p-4 text-sm text-slate-700 animate-fade-in hidden">
                                    <div class="flex items-start gap-3">
                                        <i class="fas fa-info-circle text-brand-main mt-0.5 text-lg"></i>
                                        <div id="subTypeInfoText"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Půjčka / Dluh (Základní Input) -->
                            <div class="mb-10">
                                <div class="flex justify-between items-end mb-4">
                                    <label id="loanLabel" class="text-sm font-bold text-slate-600 tracking-wide uppercase">Kolik si chcete půjčit <span class="text-slate-400 font-normal normal-case">(v Kč)</span></label>
                                    <input type="text" id="loanInputDisplay" class="text-right font-extrabold text-3xl text-brand-dark border-b-2 border-slate-200 focus:border-brand-cyan outline-none w-56 bg-transparent transition-colors p-1" value="6 000 000">
                                </div>
                                <input type="range" id="loanRange" min="500000" max="30000000" step="100000" value="6000000" class="w-full">
                                <div class="flex justify-between text-xs font-medium text-slate-400 mt-3">
                                    <span id="loanMinLabel">500 tis.</span>
                                    <span id="loanMaxLabel">30 mil.</span>
                                </div>
                            </div>

                            <!-- Extra Money (Only for Consolidation) -->
                            <div id="extraMoneyBlock" class="mb-10 hidden">
                                <div class="flex justify-between items-end mb-4">
                                    <label class="text-sm font-bold text-slate-600 tracking-wide uppercase">Potřebujete peníze navíc? <span class="text-slate-400 font-normal normal-case">(v Kč)</span></label>
                                    <input type="text" id="extraInputDisplay" class="text-right font-extrabold text-3xl text-brand-dark border-b-2 border-slate-200 focus:border-brand-cyan outline-none w-56 bg-transparent transition-colors p-1" value="0">
                                </div>
                                <input type="range" id="extraRange" min="0" max="1000000" step="10000" value="0" class="w-full">
                                <div class="flex justify-between text-xs font-medium text-slate-400 mt-3">
                                    <span>0 Kč</span>
                                    <span>1 mil.</span>
                                </div>
                            </div>

                            <!-- Vlastní zdroje (LTV base logic) -->
                            <div id="ownResourcesBlock" class="mb-10 transition-all duration-300">
                                <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-3">
                                    <label class="text-sm font-bold text-slate-600 tracking-wide uppercase">Vlastní zdroje <span class="text-slate-400 font-normal normal-case">(v Kč)</span></label>
                                    
                                    <!-- LTV / Akontace Tlačítka -->
                                    <div id="ltvButtonsContainer" class="flex flex-wrap items-center gap-2 bg-slate-50 p-1 rounded-lg">
                                        <!-- Injected via JS -->
                                    </div>
                                </div>

                                <div class="flex justify-end mb-2">
                                    <input type="text" id="ownInputDisplay" class="text-right font-extrabold text-3xl text-brand-dark border-b-2 border-slate-200 focus:border-brand-cyan outline-none w-56 bg-transparent transition-colors p-1" value="600 000">
                                </div>
                                
                                <input type="range" id="ownRange" min="0" max="15000000" step="10000" value="600 000" class="w-full">
                                <div class="flex justify-between text-xs font-medium text-slate-400 mt-3">
                                    <span>0 Kč</span>
                                    <span>15 mil.</span>
                                </div>
                                
                                <!-- Investiční/Americká hypo upozornění -->
                                <div id="investInfo" class="hidden mt-3 text-xs text-brand-cyan font-medium flex items-center gap-2">
                                    <i class="fas fa-lock"></i> U tohoto typu hypotéky je maximální LTV omezeno (typicky 60–70 %).
                                </div>
                            </div>

                            <!-- Info box nemovitost / auto -->
                            <div id="propertyInfoBlock" class="bg-blue-50/50 rounded-xl p-4 mb-8 flex justify-between items-center border border-blue-100/50 transition-all duration-300">
                                <div class="text-sm text-slate-500 font-medium">
                                    <i class="fas fa-home mr-2 text-brand-main" id="propertyIcon"></i>
                                    <span id="propertyLabel">Hodnota nemovitosti:</span>
                                </div>
                                <div class="font-bold text-brand-dark text-lg" id="propertyValueDisplay">6 600 000 Kč</div>
                            </div>

                            <!-- Parametry Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <!-- Doba splácení (Range Slider for better UX) -->
                                <div>
                                    <label class="block text-sm font-bold text-slate-600 mb-4 uppercase tracking-wide">Doba splácení</label>
                                    <div class="flex items-center gap-4">
                                        <input type="range" id="termRange" min="5" max="35" step="1" value="30" class="flex-1">
                                        <div class="bg-slate-50 border border-slate-200 rounded-lg px-4 py-2 font-bold text-brand-dark min-w-[80px] text-center">
                                            <span id="termDisplay">30</span> let
                                        </div>
                                    </div>
                                    <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                        <span id="termMinLabel">5 let</span>
                                        <span id="termMaxLabel">35 let</span>
                                    </div>
                                </div>

                                <!-- Fixace (Only for Mortgage) -->
                                <div id="fixationBlock">
                                    <label class="block text-sm font-bold text-slate-600 mb-2 uppercase tracking-wide">Fixace úroku</label>
                                    <div class="relative">
                                        <select id="fix" class="w-full appearance-none bg-slate-50 border border-slate-200 text-brand-dark font-bold py-3.5 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-cyan focus:border-transparent cursor-pointer shadow-sm" onchange="calculate()">
                                            <option value="3">3 roky</option>
                                            <option value="5" selected>5 let</option>
                                            <option value="7">7 let</option>
                                            <option value="10">10 let</option>
                                        </select>
                                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-slate-500">
                                            <i class="fas fa-chevron-down text-xs"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- LTV info (Optional warning - Only Mortgage) -->
                            <div id="ltvWarning" class="hidden mt-6 p-4 bg-orange-50 text-orange-800 rounded-xl text-sm border border-orange-100 flex items-start gap-3 transition-all duration-300">
                                <i class="fas fa-exclamation-triangle mt-0.5 text-brand-cyan"></i>
                                <div>
                                    <strong>Pozor na vysoké LTV (<span id="ltvValueWarning"></span>%).</strong> 
                                    Většina bank poskytuje hypotéky maximálně do 80 % nebo 90 % hodnoty nemovitosti.
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- PRAVÁ ČÁST: STICKY VÝSLEDEK (5 columns) -->
                    <div class="lg:col-span-5">
                        <div class="sticky top-8">
                            <!-- Dark Card -->
                            <div class="bg-brand-dark text-white rounded-2xl shadow-2xl shadow-brand-dark/30 border border-slate-800 p-8 overflow-hidden relative">
                                <!-- Background decoration -->
                                <div class="absolute top-0 right-0 w-48 h-48 bg-brand-main opacity-20 rounded-full blur-2xl -mr-10 -mt-10"></div>
                                <div class="absolute bottom-0 left-0 w-32 h-32 bg-brand-cyan opacity-10 rounded-full blur-xl -ml-10 -mb-10"></div>

                                <h3 class="text-slate-400 font-medium mb-2 relative z-10 text-sm uppercase tracking-wider">Měsíční splátka od</h3>
                                <div class="flex items-baseline gap-2 mb-8 relative z-10">
                                    <span id="monthlyPayment" class="text-5xl md:text-6xl font-black text-white tracking-tight">--</span>
                                    <span class="text-2xl font-medium text-slate-500">Kč</span>
                                </div>

                                <div class="space-y-0 relative z-10 bg-slate-800/50 rounded-xl p-1 backdrop-blur-sm border border-white/5">
                                    <div class="flex justify-between items-center p-4 border-b border-white/10">
                                        <span class="text-slate-300 text-sm">Odhad úroku</span>
                                        <span class="font-bold text-brand-cyan text-lg" id="rateResult">-- %</span>
                                    </div>
                                    <!-- LTV Row -->
                                    <div id="ltvResultRow" class="flex justify-between items-center p-4 border-b border-white/10 transition-all duration-300">
                                        <span class="text-slate-300 text-sm" id="ltvResultLabel">LTV</span>
                                        <span class="font-bold text-brand-cyan text-lg" id="ltvResult">-- %</span>
                                    </div>
                                    <div class="flex justify-between items-center p-4">
                                        <span class="text-slate-300 text-sm">Celkem zaplatíte</span>
                                        <span class="font-bold text-white text-lg" id="totalPaidResult">-- Kč</span>
                                    </div>
                                </div>

                                <div class="mt-8 relative z-10">
                                    <button onclick="openGenericModal()" class="lead-cta-btn group relative w-full py-5 px-6 rounded-xl transition-all transform hover:scale-[1.02] overflow-hidden">
                                        <div class="relative flex items-center justify-center gap-3 text-white font-extrabold text-lg">
                                            <span>Chci nezávaznou nabídku</span>
                                            <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                                        </div>
                                    </button>
                                    <p class="text-xs text-slate-500 mt-4 text-center leading-relaxed opacity-60">
                                        Kliknutím získáte srovnání na míru. Nejedná se o návrh na uzavření smlouvy.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Seznam Bank (ROZTAŽENÉ POD INPUTY) -->
                <div class="max-w-7xl mx-auto mt-12 mb-20">
                     <div id="offersContainer" class="grid grid-cols-1 gap-4">
                        <!-- Offers injected via JS -->
                     </div>
                </div>

                <!-- Mobilní floating splátka -->
                <div id="mobile-result-container" class="lg:hidden hidden-mobile-float">
                    <div class="bg-brand-dark text-white rounded-2xl shadow-2xl shadow-brand-dark/30 border border-slate-800 p-6 overflow-hidden relative" id="mobile-result-card">
                         <div class="absolute top-0 right-0 w-32 h-32 bg-brand-main opacity-20 rounded-full blur-2xl -mr-10 -mt-10"></div>
                         <h3 class="text-slate-400 font-medium mb-1 relative z-10 text-xs uppercase tracking-wider">Měsíční splátka od</h3>
                         <div class="flex items-baseline gap-2 mb-4 relative z-10">
                             <span id="monthlyPaymentMobile" class="text-3xl font-black text-white tracking-tight">--</span>
                             <span class="text-lg font-medium text-slate-500">Kč</span>
                         </div>
                         <button onclick="window.scrollTo({ top: 0, behavior: 'smooth' }); openGenericModal();" class="lead-cta-btn w-full py-3 rounded-xl text-white font-bold">
                             Získejte nezávaznou nabídku
                         </button>
                    </div>
                </div>

                <!-- Spočítejte si sami – stejný styl jako Moje služby na main indexu -->
                <div class="max-w-7xl mx-auto mt-20 mb-20 pt-10 border-t border-brand-border/50">
                    <h3 class="text-2xl font-bold text-brand-navy mb-8 text-center">Spočítejte si sami</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
                        <a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Investiční kalkulačka</h3>
                                        <p class="text-brand-muted text-sm">Zhodnocování úspor a renta</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Spočítejte si vývoj investice v čase.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"/></svg>Investiční kalkulačka</span>
                            </div>
                        </a>
                        <a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Penzijní kalkulačka</h3>
                                        <p class="text-brand-muted text-sm">Státní důchod a úspory</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Realita důchodů a nutné spoření.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>Penzijní kalkulačka</span>
                            </div>
                        </a>
                        <a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Životní pojištění</h3>
                                        <p class="text-brand-muted text-sm">Krytí pro rodinu</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Výpočet potřebného krytí.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"/></svg>Kalkulačka pojištění</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Loga bank – nekonečný pás (2 sady = seamless loop) -->
                <div class="mt-24 pt-10 border-t border-brand-border/50 overflow-hidden relative">
                    <div class="flex overflow-hidden py-4" style="mask-image: linear-gradient(90deg, transparent 0%, black 5%, black 95%, transparent 100%); -webkit-mask-image: linear-gradient(90deg, transparent 0%, black 5%, black 95%, transparent 100%);">
                        <div class="animate-scroll">
                            <div class="partner-logo"><img src="../assets/img/kb-logo.png" alt="KB" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=KB';"></div>
                            <div class="partner-logo"><img src="../assets/img/csob-logo.png" alt="ČSOB" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=CSOB';"></div>
                            <div class="partner-logo"><img src="../assets/img/raiffeisenbank-logo.png" alt="Raiffeisen" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=RB';"></div>
                            <div class="partner-logo"><img src="../assets/img/unicredit-logo.png" alt="UniCredit" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=UCB';"></div>
                            <div class="partner-logo"><img src="../assets/img/ceskasporitelna-logo.png" alt="Česká spořitelna" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=CS';"></div>
                            <div class="partner-logo"><img src="../assets/img/kb-logo.png" alt="" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=KB';"></div>
                            <div class="partner-logo"><img src="../assets/img/csob-logo.png" alt="" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=CSOB';"></div>
                            <div class="partner-logo"><img src="../assets/img/raiffeisenbank-logo.png" alt="" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=RB';"></div>
                            <div class="partner-logo"><img src="../assets/img/unicredit-logo.png" alt="" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=UCB';"></div>
                            <div class="partner-logo"><img src="../assets/img/ceskasporitelna-logo.png" alt="" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=CS';"></div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

    <!-- QUICK-CALC WIDGET – Plovoucí menu kalkulaček -->
    <div class="qc-widget" aria-label="Rychlé kalkulačky">
      <button type="button" class="qc-button" aria-expanded="false" aria-controls="qc-panel">
        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="4" y="3" width="16" height="18" rx="2" ry="2"></rect>
          <line x1="8" y1="9" x2="16" y2="9"></line>
          <line x1="9" y1="13" x2="9" y2="13"></line>
          <line x1="12" y1="13" x2="12" y2="13"></line>
          <line x1="15" y1="13" x2="15" y2="13"></line>
          <line x1="9" y1="16" x2="9" y2="16"></line>
          <line x1="12" y1="16" x2="12" y2="16"></line>
        </svg>
      </button>
      <div id="qc-panel" class="qc-panel" role="dialog" aria-modal="false">
        <h3 class="text-sm font-bold text-brand-navy mb-1">Rychlé kalkulačky</h3>
        <p class="text-xs text-slate-500 mb-4">Vyberte, co chcete spočítat.</p>
        <div class="space-y-2 text-sm">
          <a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="qc-link">
            <span class="qc-icon">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
            </span>
            <span>
              <span class="font-semibold block">Hypoteční kalkulačka</span>
              <span class="block text-xs text-slate-500">Výše splátky a celkové náklady</span>
            </span>
          </a>
          <a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="qc-link">
            <span class="qc-icon">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M7 21V10"/><path d="M12 21V3"/><path d="M17 21v-6"/></svg>
            </span>
            <span>
              <span class="font-semibold block">Investiční kalkulačka</span>
              <span class="block text-xs text-slate-500">Projekce zhodnocení v čase</span>
            </span>
          </a>
          <a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="qc-link">
            <span class="qc-icon">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"/></svg>
            </span>
            <span>
              <span class="font-semibold block">Kalkulačka životního pojištění</span>
              <span class="block text-xs text-slate-500">Potřebné krytí podle situace</span>
            </span>
          </a>
          <a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="qc-link">
            <span class="qc-icon">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>
            </span>
            <span>
              <span class="font-semibold block">Penzijní kalkulačka</span>
              <span class="block text-xs text-slate-500">Státní příspěvky a daňové úlevy</span>
            </span>
          </a>
        </div>
      </div>
    </div>
    </main>

    <!-- --- FOOTER PB (Marek Příbramský) --- -->
  <footer class="bg-brand-navy text-white py-10 sm:py-12 lg:py-16" role="contentinfo">
  <div class="footer-inner mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8 sm:gap-10 lg:gap-12 mb-8 sm:mb-10 lg:mb-12">
      <div class="md:col-span-2 lg:col-span-2">
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-2">
            <a href="https://www.marekpribramsky.cz/" class="shrink-0">
              <img src="../assets/img/logos/pb-logo-no-bg-grey.png" alt="Premium Brokers" class="h-10 w-auto" />
            </a>
            <span class="font-bold text-xl">Marek Příbramský</span>
          </div>
          <p class="text-slate-300 text-sm max-w-sm mb-4">Privátní finanční plánování pro lidi, kteří chtějí mít klid. Pomáhám rodinám a podnikatelům sestavit strategie, které dávají smysl.</p>
          <span class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Sledujte mě</span>
          <div class="flex flex-wrap gap-3 social-icons-row">
            <a href="https://www.facebook.com/PremiumBrokersRCE" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--fb social-icon-link" aria-label="Facebook">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            </a>
            <a href="https://www.instagram.com/premiumbrokers.cz/" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--ig social-icon-link" aria-label="Instagram">
              <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
            </a>
            <a href="https://www.linkedin.com/in/marek-pribramsky/" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--li social-icon-link" aria-label="LinkedIn">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          </div>
        </div>
      </div>
      <div>
        <h4 class="font-bold text-sm uppercase tracking-wider mb-4">Rychlé odkazy</h4>
        <ul class="space-y-2 text-sm">
          <li><a href="https://www.marekpribramsky.cz/#sluzby" class="text-slate-300 hover:text-white">Služby</a></li>
          <li><a href="https://www.marekpribramsky.cz/#pobocky" class="text-slate-300 hover:text-white">Pobočky</a></li>
          <li><a href="https://www.marekpribramsky.cz/blog" class="text-slate-300 hover:text-white">Blog</a></li>
          <li><a href="https://www.marekpribramsky.cz/spoluprace" class="text-slate-300 hover:text-white">Spolupráce</a></li>
          <li><a href="https://www.marekpribramsky.cz/kontakt" class="text-slate-300 hover:text-white">Kontakt</a></li>
        </ul>
      </div>
      <div>
        <h4 class="font-bold text-sm uppercase tracking-wider mb-4">Nástroje</h4>
        <ul class="space-y-2 text-sm">
          <li><a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="text-slate-300 hover:text-white">Hypoteční kalkulačka</a></li>
          <li><a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="text-slate-300 hover:text-white">Investiční kalkulačka</a></li>
          <li><a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="text-slate-300 hover:text-white">Životní pojištění</a></li>
          <li><a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="text-slate-300 hover:text-white">Penzijní kalkulačka</a></li>
        </ul>
      </div>
      <div>
        <h4 class="font-bold text-sm uppercase tracking-wider mb-4">Pobočky</h4>
        <ul class="space-y-2 text-sm text-slate-300">
          <li><strong class="text-white">Roudnice nad Labem</strong><br>Nám. Jana z Dražic 99, 413 01</li>
          <li><strong class="text-white">Štětí</strong><br>U Tržnice 701, 411 08</li>
          <li><strong class="text-white">Litoměřice</strong><br>5. května 10, 412 01</li>
          <li><strong class="text-white">Praha</strong><br>Žatecká 55/14, 110 00</li>
          <li><strong class="text-white">Lovosice</strong><br><span class="text-slate-400">Brzy otevíráme</span></li>
        </ul>
      </div>
      <div>
        <h4 class="font-bold text-sm uppercase tracking-wider mb-4">Kontakt</h4>
        <ul class="space-y-3 text-sm text-slate-300">
          <li><a href="tel:+420728480423" class="hover:text-white">+420 728 480 423</a></li>
          <li><a href="mailto:pribramsky@premiumbrokers.cz" class="hover:text-white">pribramsky@premiumbrokers.cz</a></li>
        </ul>
      </div>
    </div>
    <div class="border-t border-white/10 pt-8 space-y-4">
      <div class="flex flex-col sm:flex-row justify-between items-center gap-4 text-xs text-slate-400">
        <p>&copy; 2025 Marek Příbramský. Všechna práva vyhrazena.</p>
        <div class="flex gap-6">
          <a href="https://www.beplan.cz/ochrana-osobnich-udaju/" target="_blank" rel="noopener noreferrer" class="hover:text-white">Ochrana osobních údajů</a>
          <a href="https://www.marekpribramsky.cz/cookies" class="hover:text-white">Cookies</a>
        </div>
      </div>
      <p class="text-[10px] text-slate-500 leading-relaxed max-w-3xl">
        Ing. Marek Příbramský, IČO: 02024870 je vázaným zástupcem samostatného zprostředkovatele BEplan finanční plánování s.r.o., IČO: 05779944. Služby jsou poskytovány v rámci následujících registrací. Pojištění: vázaný zástupce podle zákona č. 170/2018 Sb., o distribuci pojištění a zajištění. Spotřebitelské úvěry: vázaný zástupce podle zákona č. 257/2016 Sb., o spotřebitelském úvěru. Investiční služby a produkty: vázaný zástupce podle zákona č. 256/2004 Sb., o podnikání na kapitálovém trhu. Doplňkové penzijní spoření: vázaný zástupce podle zákona č. 427/2011 Sb., o doplňkovém penzijním spoření.
      </p>
      <p class="text-sm text-slate-400">
        Vytvořil <a href="https://www.m2digitalagency.cz/" target="_blank" rel="noopener noreferrer" class="hover:text-white font-medium">M2DigitalAgency</a>
      </p>
    </div>
  </div>
</footer>
    <!-- --- FOOTER KONEC --- -->

    <!-- KONTAKTNÍ MODAL -->
    <div id="contactModal" class="fixed inset-0 z-50 hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-brand-dark/80 backdrop-blur-sm transition-opacity opacity-0" id="modalBackdrop"></div>
        
        <!-- Modal Content -->
        <div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-none">
            <div id="modalContentContainer" class="neu-raised rounded-3xl w-full max-w-md transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto relative overflow-hidden">
                <!-- Modal content injected by renderModalContent() -->
            </div>
        </div>
    </div>

    <!-- JavaScript pro funkčnost -->
    <script>
        // --- CONFIG & DATA ---
        const banksData = [
            // Realistic Czech bank rates for mortgage and loan, simulated based on current market trends (Q4 2024 / Q1 2025)
            // baseRate is for a default 80% LTV, 5Y fix mortgage
            { id: 'rb', name: 'Raiffeisenbank', baseRate: 4.39, loanRate: 5.9, logoUrl: '../assets/img/raiffeisenbank-logo.png' },
            { id: 'ucb', name: 'UniCredit Bank', baseRate: 4.39, loanRate: 6.5, logoUrl: '../assets/img/unicredit-logo.png' },
            { id: 'csob', name: 'ČSOB', baseRate: 4.79, loanRate: 7.9, logoUrl: '../assets/img/csob-logo.png' },
            { id: 'kb', name: 'Komerční banka', baseRate: 4.99, loanRate: 6.9, logoUrl: '../assets/img/kb-logo.png' },
            // Placeholder/other major bank
            { id: 'cs', name: 'Česká spořitelna', baseRate: 4.59, loanRate: 7.5, logoUrl: '../assets/img/ceskasporitelna-logo.png' },
            { id: 'mbank', name: 'mBank', baseRate: 4.55, loanRate: 6.2, logoUrl: '../assets/img/mbank-logo.png' }
        ];

        // Definitions of product sub-types with info text
        const productTypes = {
            mortgage: [
                { id: 'standard', label: 'Klasická', info: 'Nejčastější hypotéka na vlastní bydlení. Výhodná sazba a možnost LTV až 90 %.' },
                { id: 'investment', label: 'Investiční', info: 'Hypotéka na nemovitost k pronájmu. Pozor: LTV je bankami omezeno na maximálně 70 %.' },
                { id: 'american', label: 'Americká', info: 'Neúčelová hypotéka zajištěná nemovitostí. Peníze můžete použít na cokoliv, ale sazba bývá vyšší. Max LTV 70 %.' }
            ],
            loan: [
                { id: 'consumer', label: 'Spotřebitelský', info: 'Klasická půjčka na cokoliv bez zajištění nemovitostí. Rychlé vyřízení.' },
                { id: 'auto', label: 'Auto / Leasing', info: 'Účelová půjčka na nákup automobilu. Často s výhodnější sazbou než běžný úvěr.' },
                { id: 'consolidation', label: 'Konsolidace', info: 'Sloučení více půjček, kreditek a kontokorentů do jedné. Získáte nižší splátku a lepší přehled.' }
            ]
        };

        // --- STATE MANAGEMENT ---
        let state = {
            product: 'mortgage', 
            mortgageType: 'standard', 
            loanType: 'consumer', 
            loan: 6000000,
            own: 600000, 
            extra: 0, 
            term: 30,
            fix: 5,
            type: 'new',
            ltvLock: 90 
        };

        const limits = {
            mortgage: { min: 500000, max: 30000000, step: 100000, default: 6000000 },
            loan: { min: 20000, max: 2500000, step: 5000, default: 200000 }
        };

        // --- DOM ELEMENTS ---
        function getEls() {
            return {
                // Inputs
                loanRange: document.getElementById('loanRange'),
                loanInput: document.getElementById('loanInputDisplay'),
                ownRange: document.getElementById('ownRange'),
                ownInput: document.getElementById('ownInputDisplay'),
                extraRange: document.getElementById('extraRange'),
                extraInput: document.getElementById('extraInputDisplay'),
                termRange: document.getElementById('termRange'),
                
                // Displays
                propertyValueDisplay: document.getElementById('propertyValueDisplay'),
                termDisplay: document.getElementById('termDisplay'),
                monthly: document.getElementById('monthlyPayment'),
                rate: document.getElementById('rateResult'),
                ltv: document.getElementById('ltvResult'),
                ltvLabel: document.getElementById('ltvResultLabel'),
                total: document.getElementById('totalPaidResult'),
                
                // Sections & Labels
                loanLabel: document.getElementById('loanLabel'),
                loanMinLabel: document.getElementById('loanMinLabel'),
                loanMaxLabel: document.getElementById('loanMaxLabel'),
                termMinLabel: document.getElementById('termMinLabel'),
                termMaxLabel: document.getElementById('termMaxLabel'),
                tabNewText: document.getElementById('tabNewText'),
                propertyLabel: document.getElementById('propertyLabel'),
                propertyIcon: document.getElementById('propertyIcon'),
                
                // Containers
                subTabs: document.getElementById('subTabs'),
                ownResourcesBlock: document.getElementById('ownResourcesBlock'),
                fixationBlock: document.getElementById('fixationBlock'),
                propertyInfoBlock: document.getElementById('propertyInfoBlock'),
                extraMoneyBlock: document.getElementById('extraMoneyBlock'),
                ltvResultRow: document.getElementById('ltvResultRow'),
                ltvWarning: document.getElementById('ltvWarning'),
                ltvValueWarning: document.getElementById('ltvValueWarning'),
                offersContainer: document.getElementById('offersContainer'),
                
                // Sub Type Logic
                subTypeContainer: document.getElementById('subTypeContainer'),
                subTypeInfoBox: document.getElementById('subTypeInfoBox'),
                subTypeInfoText: document.getElementById('subTypeInfoText'),
                investInfo: document.getElementById('investInfo'),
                ltvButtonsContainer: document.getElementById('ltvButtonsContainer'),
                
                // Modals & Switches
                modal: document.getElementById('contactModal'),
                modalBackdrop: document.getElementById('modalBackdrop'),
                modalContentContainer: document.getElementById('modalContentContainer'),
                tabs: document.querySelectorAll('.hx-tab'),
                prodSwitches: document.querySelectorAll('.prod-switch'),
                fixationSelect: document.getElementById('fix')
            };
        }

        // --- FORMATTERS ---
        const formatCurrency = (num) => num.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        const parseCurrency = (str) => parseInt(str.replace(/\s/g, '').replace(' ', ''), 10) || 0;

        // --- RENDER HELPERS ---
        function renderLtvButtons() {
            const els = getEls();
            els.ltvButtonsContainer.innerHTML = '';
            
            if (state.product === 'mortgage') {
                const values = [90, 80, 70, 60, 50];
                const label = document.createElement('span');
                label.className = "text-xs font-bold text-slate-400 pl-2";
                label.innerText = "LTV:";
                els.ltvButtonsContainer.appendChild(label);

                values.forEach(val => {
                    const isActive = state.ltvLock === val;
                    let disabled = false;
                    if ((state.mortgageType === 'investment' || state.mortgageType === 'american') && val > 70) {
                        disabled = true;
                    }
                    
                    const button = document.createElement('button');
                    button.innerText = val + '%';
                    button.className = `text-xs font-bold px-3 py-1.5 rounded-md transition-colors ${isActive ? 'bg-brand-navy text-white shadow-md' : 'text-slate-600 hover:bg-brand-navy hover:text-white'} ${disabled ? 'disabled-btn' : ''}`;
                    button.onclick = () => { if (!disabled) setLtv(val); };
                    els.ltvButtonsContainer.appendChild(button);
                });

            } else if (state.product === 'loan' && state.loanType === 'auto') {
                const values = [0, 10, 20, 30, 40, 50];
                const label = document.createElement('span');
                label.className = "text-xs font-bold text-slate-400 pl-2";
                label.innerText = "Akontace:";
                els.ltvButtonsContainer.appendChild(label);

                values.forEach(val => {
                    const isActive = state.ltvLock === val;
                    const button = document.createElement('button');
                    button.innerText = val + '%';
                    button.className = `text-xs font-bold px-3 py-1.5 rounded-md transition-colors ${isActive ? 'bg-brand-navy text-white shadow-md' : 'text-slate-600 hover:bg-brand-navy hover:text-white'}`;
                    button.onclick = () => setLtv(val);
                    els.ltvButtonsContainer.appendChild(button);
                });
            }
        }

        function renderSubTypeButtons() {
            const els = getEls();
            const types = productTypes[state.product];
            const currentSelected = state.product === 'mortgage' ? state.mortgageType : state.loanType;
            
            let html = '';
            els.subTypeInfoBox.classList.add('hidden');

            types.forEach(t => {
                const isActive = t.id === currentSelected;
                const activeClass = isActive 
                    ? 'bg-white text-brand-navy border-brand-border shadow-md' 
                    : 'bg-slate-50 text-slate-600 border-slate-200 hover:bg-white hover:border-slate-300';
                
                html += `
                    <button onclick="selectSubType('${t.id}')" class="${activeClass} px-4 py-3 rounded-lg text-sm font-bold transition-all duration-200 flex items-center gap-2 group border">
                        ${t.label}
                    </button>
                `;
                
                if (isActive) {
                    els.subTypeInfoText.innerHTML = t.info;
                    els.subTypeInfoBox.classList.remove('hidden');
                }
            });
            els.subTypeContainer.innerHTML = html;
        }

        // --- ACTION HANDLERS ---
        function selectSubType(id) {
            if (state.product === 'mortgage') {
                state.mortgageType = id;
                if (id === 'investment' || id === 'american') {
                    const currentLtv = getCalculatedLtv();
                    if (state.ltvLock > 70 || currentLtv > 70) {
                        setLtv(70); 
                    }
                }
            } else {
                state.loanType = id;
            }
            updateViewConfig();
            renderSubTypeButtons();
            renderLtvButtons();
            calculate();
        }

        function switchProduct(prodType) {
            const els = getEls();
            state.product = prodType;
            
            if (prodType === 'mortgage') {
                state.mortgageType = 'standard';
                state.loan = limits.mortgage.default;
                state.ltvLock = 90;
                
                // FINANČNÍ MATEMATIKA: Simplified per user request
                // Own = 10% of Loan Amount for 90% LTV
                state.own = state.loan * 0.1;

                els.loanInput.value = formatCurrency(state.loan);
                els.loanRange.value = state.loan;
                els.ownInput.value = formatCurrency(state.own);
                els.ownRange.value = state.own;
            } else {
                state.loanType = 'consumer';
                state.loan = limits.loan.default;
                state.own = 0; 
                state.extra = 0; 
                els.loanInput.value = formatCurrency(state.loan);
                els.loanRange.value = state.loan;
            }
            state.term = 30; 
            els.termRange.value = state.term;

            els.prodSwitches.forEach(btn => {
                if(btn.dataset.prod === prodType) {
                    btn.classList.add('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    btn.classList.remove('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                } else {
                    btn.classList.remove('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    btn.classList.add('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                }
            });

            updateViewConfig();
            renderSubTypeButtons();
            renderLtvButtons();
            calculate();
        }

        function switchTab(type) {
            const els = getEls();
            state.type = type;
            els.tabs.forEach(t => {
                if(t.dataset.tab === type) {
                    t.classList.add('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    t.classList.remove('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                } else {
                    t.classList.remove('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    t.classList.add('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                }
            });
            calculate();
        }

        function updateViewConfig() {
            const els = getEls();
            els.tabNewText.innerText = state.product === 'mortgage' ? 'Nová hypotéka' : 'Nový úvěr';

            const lim = limits[state.product];
            els.loanRange.min = lim.min;
            els.loanRange.max = lim.max;
            els.loanRange.step = lim.step;
            
            if (state.product === 'mortgage') {
                els.loanMinLabel.innerText = "500 tis.";
                els.loanMaxLabel.innerText = "30 mil.";
                els.termRange.min = 5;
                els.termRange.max = 35;
                els.termMinLabel.innerText = "5 let";
                els.termMaxLabel.innerText = "35 let";
                els.ownResourcesBlock.classList.remove('hidden');
                els.fixationBlock.classList.remove('hidden');
                els.propertyInfoBlock.classList.remove('hidden');
                els.ltvResultRow.classList.remove('hidden');
                els.extraMoneyBlock.classList.add('hidden');
                els.ltvWarning.classList.remove('hidden');
                els.loanLabel.innerHTML = '<span class="uppercase">Kolik si chcete půjčit</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>';
                els.propertyLabel.innerText = "Hodnota nemovitosti:";
                els.propertyIcon.className = "fas fa-home mr-2 text-brand-main";
                els.ltvLabel.innerText = "LTV";
                
                if(state.mortgageType === 'investment' || state.mortgageType === 'american') {
                    els.investInfo.classList.remove('hidden');
                } else {
                    els.investInfo.classList.add('hidden');
                }
            } else {
                els.loanMinLabel.innerText = "20 tis.";
                els.loanMaxLabel.innerText = "2,5 mil.";
                if(state.loanType === 'auto') {
                    els.termRange.max = 10;
                    els.termMaxLabel.innerText = "10 let";
                } else {
                    els.termRange.max = 12;
                    els.termMaxLabel.innerText = "12 let";
                }
                els.termRange.min = 1;
                els.termMinLabel.innerText = "1 rok";
                els.fixationBlock.classList.add('hidden');
                els.ltvWarning.classList.add('hidden');
                els.investInfo.classList.add('hidden'); 
                
                if (state.loanType === 'consolidation') {
                    els.loanLabel.innerHTML = '<span class="uppercase">Kolik máte stávající závazky</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>';
                    els.extraMoneyBlock.classList.remove('hidden');
                    els.ownResourcesBlock.classList.add('hidden');
                    els.propertyInfoBlock.classList.add('hidden');
                    els.ltvResultRow.classList.add('hidden');
                } 
                else if (state.loanType === 'auto') {
                    els.loanLabel.innerHTML = '<span class="uppercase">Cena vozu</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>';
                    els.ownResourcesBlock.classList.remove('hidden'); 
                    els.propertyInfoBlock.classList.remove('hidden'); 
                    els.propertyLabel.innerText = "Výše úvěru:";
                    els.propertyIcon.className = "fas fa-car mr-2 text-brand-main";
                    els.ltvResultRow.classList.remove('hidden');
                    els.ltvLabel.innerText = "Akontace";
                    els.extraMoneyBlock.classList.add('hidden');
                } 
                else { 
                    els.loanLabel.innerHTML = '<span class="uppercase">Kolik si chcete půjčit</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>';
                    els.ownResourcesBlock.classList.add('hidden');
                    els.propertyInfoBlock.classList.add('hidden');
                    els.extraMoneyBlock.classList.add('hidden');
                    els.ltvResultRow.classList.add('hidden');
                }
            }
            els.termDisplay.innerText = state.term;
        }

        // --- HELPER FOR LTV CALCULATION ---
        function getCalculatedLtv() {
            if (state.product === 'mortgage') {
                const propertyValue = state.loan + state.own;
                if (propertyValue > 0) {
                    return Math.round((state.loan / propertyValue) * 100);
                }
                return 0;
            } else if (state.product === 'loan' && state.loanType === 'auto') {
                if (state.loan > 0) {
                    return Math.round((state.own / state.loan) * 100); 
                }
                return 0;
            }
            return 0;
        }

        // --- LOGIC: UPDATE INPUTS ---
        function updateLoan(val) {
            const els = getEls();
            const lim = limits[state.product];
            if (val < lim.min) val = lim.min;
            if (val > lim.max) val = lim.max;
            
            state.loan = val;
            els.loanInput.value = formatCurrency(val);
            els.loanRange.value = val;

            if (state.ltvLock !== null) {
                 if (state.product === 'mortgage') {
                    // Own = (100 - LTV_Button)% * Loan Amount
                    const ownPercent = (100 - state.ltvLock) / 100;
                    state.own = Math.round((state.loan * ownPercent) / 1000) * 1000;
                } 
                else if (state.product === 'loan' && state.loanType === 'auto') {
                    const akoDec = state.ltvLock / 100;
                    state.own = Math.round((state.loan * akoDec) / 1000) * 1000;
                }
                
                els.ownInput.value = formatCurrency(state.own);
                els.ownRange.value = state.own;
            }
            calculate();
        }

        function updateOwn(val) {
            const els = getEls();
            state.own = val;
            els.ownInput.value = formatCurrency(val);
            els.ownRange.value = val;
            state.ltvLock = null; // Manual change breaks LTV button link
            renderLtvButtons();
            calculate();
        }
        
        function updateExtra(val) {
            const els = getEls();
            state.extra = val;
            els.extraInput.value = formatCurrency(val);
            els.extraRange.value = val;
            calculate();
        }

        function setLtv(targetVal) {
            const els = getEls();
            if ((state.mortgageType === 'investment' || state.mortgageType === 'american') && targetVal > 70) return;

            state.ltvLock = targetVal;
            renderLtvButtons();
            
            if (state.product === 'mortgage') {
                // Own = (100 - targetVal)% * Loan Amount
                const ownPercent = (100 - targetVal) / 100;
                state.own = Math.round((state.loan * ownPercent) / 1000) * 1000;
            } 
            else if (state.product === 'loan' && state.loanType === 'auto') {
                state.own = Math.round((state.loan * (targetVal / 100)) / 1000) * 1000;
            }
            
            els.ownInput.value = formatCurrency(state.own);
            els.ownRange.value = state.own;
            calculate();
        }

        // --- MAIN CALCULATION LOGIC ---
        function calculate() {
            const els = getEls();
            let finalRate = 0;
            let monthlyPayment = 0;
            let totalPaid = 0;
            let borrowingAmount = state.loan;

            // --- MORTGAGE ---
            if (state.product === 'mortgage') {
                const propertyValue = state.loan + state.own;
                els.propertyValueDisplay.innerText = formatCurrency(propertyValue) + " Kč";
                
                const calcLtv = getCalculatedLtv();
                
                // Rate Adjustment based on LTV
                let penalty = 0.0;
                
                // Penalizace až nad 91% (protože zjednodušený výpočet 90% tlačítka dává reálné LTV cca 91%)
                if (calcLtv > 91) penalty += 1.5;
                
                if (state.mortgageType === 'american') penalty += 1.5; 
                if (state.mortgageType === 'investment') penalty += 0.4; 
                if (state.type === 'refi') penalty -= 0.2;

                const base = Math.min(...banksData.map(b => b.baseRate));
                finalRate = base + penalty;

                // Ensure rate doesn't drop below 4.39%
                if (finalRate < 4.39) finalRate = 4.39;

                const fixYears = parseInt(els.fixationSelect.value);
                if (fixYears < 5) finalRate += 0.1;
                else if (fixYears > 7) {
                     let discounted = finalRate - 0.15;
                     if (discounted < 4.39) finalRate = 4.39;
                     else finalRate = discounted;
                }
                
                // Display LTV (If button is active, we show button value for consistency)
                els.ltv.innerText = (state.ltvLock !== null ? state.ltvLock : calcLtv) + " %";
                
                if (calcLtv > 91) {
                    els.ltvWarning.classList.remove('hidden');
                    els.ltvValueWarning.innerText = calcLtv;
                } else {
                    els.ltvWarning.classList.add('hidden');
                }
            }
            
            // --- LOAN ---
            else {
                let typeMod = 0;
                if (state.loanType === 'auto') typeMod = -1.0; 
                if (state.loanType === 'consolidation') typeMod = -0.5;

                const avgRate = (banksData.reduce((acc, b) => acc + (b.loanRate || 7.0), 0) / banksData.length);
                finalRate = avgRate + typeMod; 

                if (state.loanType === 'auto') {
                    borrowingAmount = Math.max(0, state.loan - state.own); 
                    els.propertyValueDisplay.innerText = formatCurrency(borrowingAmount) + " Kč"; 
                    els.ltv.innerText = getCalculatedLtv() + " %";
                }
                else if (state.loanType === 'consolidation') {
                    borrowingAmount = state.loan + state.extra;
                }
            }
            
            const r = finalRate / 100 / 12; 
            const n = state.term * 12; 
            
            if (borrowingAmount > 0) {
                monthlyPayment = (r > 0) ? (borrowingAmount * r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1) : borrowingAmount / n;
            }

            totalPaid = monthlyPayment * n;

            els.monthly.innerText = formatCurrency(Math.round(monthlyPayment));
            els.rate.innerText = finalRate.toFixed(2).replace('.', ',') + ' %';
            els.total.innerText = formatCurrency(Math.round(totalPaid)) + ' Kč';

            renderOffers(finalRate, n, borrowingAmount);
        }

        function renderOffers(calcRate, months, borrowingAmount) {
            const els = getEls();
            let html = '';
            
            const sorted = [...banksData].sort((a,b) => {
                if(state.product === 'mortgage') return a.baseRate - b.baseRate;
                return (a.loanRate || 10) - (b.loanRate || 10);
            });

            sorted.forEach((bank, index) => {
                let bankRateVal = 0;
                if (state.product === 'mortgage') {
                    let p = 0;
                    let ltv = getCalculatedLtv();
                    
                    if(ltv > 91) p += 1.5; 
                    
                    if(state.mortgageType==='american') p+=1.5;
                    if(state.mortgageType==='investment') p+=0.4;
                    if(state.type==='refi') p-=0.2;
                    const fixYears = parseInt(els.fixationSelect.value);
                    if (fixYears < 5) p += 0.1; 
                    else if (fixYears > 7) p -= 0.15;
                    
                    bankRateVal = bank.baseRate + p;
                    if(bankRateVal < 4.39) bankRateVal = 4.39;
                } else {
                    let mod = 0;
                    if(state.loanType === 'auto') mod = -1.0;
                    if(state.loanType === 'consolidation') mod = -0.5;
                    bankRateVal = (bank.loanRate || 6.9) + mod;
                }

                const r = bankRateVal/100/12;
                let pmt = borrowingAmount > 0 ? Math.round((r > 0) ? (borrowingAmount * r * Math.pow(1 + r, months)) / (Math.pow(1 + r, months) - 1) : borrowingAmount / months) : 0;
                
                const delay = index * 70;
                html += `
                <div class="animate-fade-in bg-white border border-slate-100 rounded-xl p-5 flex flex-col md:flex-row items-center gap-6 hover:shadow-lg hover:border-brand-cyan transition-all group" style="animation-delay: ${delay}ms">
                    <img src="${bank.logoUrl}" class="bank-logo h-8" onerror="this.onerror=null;this.src='https://placehold.co/100x30/1e293b/ffffff?text=${bank.id.toUpperCase()}';">
                    <div class="flex-1 flex flex-row justify-between w-full md:w-auto items-center gap-4">
                        <div class="text-center md:text-left">
                            <div class="text-xs text-slate-400 font-semibold uppercase">Úrok</div>
                            <div class="font-bold text-brand-dark text-lg">${bankRateVal.toFixed(2).replace('.', ',')} %</div>
                        </div>
                        <div class="text-center md:text-right">
                            <div class="text-xs text-slate-400 font-semibold uppercase">Měsíčně</div>
                            <div class="font-bold text-xl text-brand-dark">${formatCurrency(pmt)} Kč</div>
                        </div>
                    </div>
                    <button onclick="openModal('${bank.name}')" class="lead-cta-btn text-white font-bold py-2 px-6 rounded-xl transition-all transform hover:-translate-y-0.5 w-full md:w-auto">
                        Chci nabídku
                    </button>
                </div>`;
            });
            els.offersContainer.innerHTML = html;
        }

        // --- MODAL & FORM ---
        function renderModalContent(bankName, contextText) {
            return `
                <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-400 hover:text-brand-dark transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 z-10">
                    <i class="fas fa-times"></i>
                </button>
                <div class="neu-flat px-8 py-8 border-b border-slate-200/50">
                    <h3 class="text-2xl font-bold text-brand-dark">Mám zájem o nabídku</h3>
                    <p class="text-sm text-slate-600 mt-2 flex items-center gap-2">
                        <i class="fas fa-info-circle text-brand-cyan"></i>
                        <span>${contextText}</span>
                    </p>
                </div>
                <div class="p-8">
                    <form id="leadForm" onsubmit="submitForm(event)" method="POST" action="https://formsubmit.co/ajax/pribramsky@premiumbrokers.cz">
                        <input type="hidden" name="banka" value="${bankName || 'Obecná poptávka'}">
                        <input type="hidden" name="typ_produktu" value="${state.product === 'mortgage' ? 'Hypotéka' : 'Úvěr'}">
                        <input type="hidden" name="typ_detail" value="${state.product === 'mortgage' ? state.mortgageType : state.loanType}">
                        <input type="hidden" name="vyse_uveru" value="${state.loan}">
                        <input type="hidden" name="vlastni_zdroje" value="${state.own}">
                        <input type="hidden" name="doba_splaceni" value="${state.term}">
                        <input type="hidden" name="fixace" value="${state.fix}">
                        <input type="hidden" name="ltv_akontace" value="${getCalculatedLtv()}">

                        <div class="space-y-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1">Jméno a příjmení <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <i class="fas fa-user absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="text" name="name" required placeholder="Jan Novák" class="w-full neu-inset neu-focus rounded-xl pl-10 pr-4 py-3 border-0 outline-none transition-shadow bg-transparent">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1">E-mail <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <i class="fas fa-envelope absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="email" name="email" required placeholder="vas@email.cz" class="w-full neu-inset neu-focus rounded-xl pl-10 pr-4 py-3 border-0 outline-none transition-shadow bg-transparent">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1">Telefon <span class="text-slate-400 font-normal">(nepovinné)</span></label>
                                <div class="relative">
                                    <i class="fas fa-phone absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="tel" name="phone" placeholder="+420 777 ..." class="w-full neu-inset neu-focus rounded-xl pl-10 pr-4 py-3 border-0 outline-none transition-shadow bg-transparent">
                                </div>
                            </div>
                            <div class="flex items-start gap-3 mt-2 neu-inset p-3 rounded-xl">
                                <input type="checkbox" id="consent" required class="mt-1 w-4 h-4 text-brand-cyan rounded border-slate-300">
                                <label for="consent" class="text-xs text-slate-600 cursor-pointer">
                                    Souhlasím se zpracováním osobních údajů za účelem vytvoření nezávazné nabídky.
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="lead-cta-btn w-full mt-8 text-white font-bold py-4 rounded-xl transition-all flex items-center justify-center gap-2 text-lg">
                            <span>Odeslat poptávku</span>
                            <i class="fas fa-paper-plane text-sm"></i>
                        </button>
                    </form>
                </div>`;
        }

        function openGenericModal() {
            const els = getEls();
            const contextText = "Poptáváte srovnání <strong>všech bank</strong>";
            els.modalContentContainer.innerHTML = renderModalContent(null, contextText);
            openModalInternal();
        }

        function openModal(bankName) {
            const els = getEls();
            const contextText = `Vybraná banka: <strong class="text-brand-main">${bankName}</strong>`;
            els.modalContentContainer.innerHTML = renderModalContent(bankName, contextText);
            openModalInternal();
        }
        
        function openModalInternal() {
            const els = getEls();
            els.modal.classList.remove('hidden');
            setTimeout(() => {
                els.modalBackdrop.classList.remove('opacity-0');
                els.modalContentContainer.classList.remove('opacity-0', 'scale-95');
                els.modalContentContainer.classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            const els = getEls();
            els.modalBackdrop.classList.add('opacity-0');
            els.modalContentContainer.classList.remove('scale-100');
            els.modalContentContainer.classList.add('opacity-0', 'scale-95');
            setTimeout(() => els.modal.classList.add('hidden'), 300);
        }
        
        async function submitForm(e) {
            e.preventDefault();
            const form = e.target;
            const btn = form.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Odesílám...';
            btn.disabled = true;

            const formData = new FormData(form);

            try {
                const response = await fetch("https://formsubmit.co/ajax/pribramsky@premiumbrokers.cz", {
                    method: "POST",
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                     document.getElementById('modalContentContainer').innerHTML = `
                        <div class="p-12 text-center">
                            <div class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6 text-3xl shadow-sm"><i class="fas fa-check"></i></div>
                            <h3 class="2xl font-bold text-brand-dark mb-2">Poptávka odeslána!</h3>
                            <p class="text-slate-600 mb-8">Děkuji. Budu Vás brzy kontaktovat.</p>
                            <button onclick="closeModal()" class="text-brand-cyan font-bold hover:underline">Zavřít okno</button>
                        </div>`;
                } else {
                    throw new Error('Chyba při odesílání');
                }
            } catch (error) {
                btn.innerHTML = originalText;
                btn.disabled = false;
                alert("Omlouváme se, došlo k chybě při odesílání formuláře. Zkuste to prosím později.");
                console.error(error);
            }
        }

        // --- HEADER JS ---
        function updateHeader() {
            const byId = (id) => document.getElementById(id);
            const $$ = (selector) => document.querySelectorAll(selector);
            const navbar = byId('navbar');
            const logoIcon = byId('logo-icon');
            const logoText = byId('logo-text');
            const logoSubtext = byId('logo-subtext');
            const navLinks = $$('.nav-link');
            const dividers = $$('[id^="nav-divider"]');
            const logoImg = byId('logo-img');

            if (!navbar) return;

            if (window.scrollY > 20) {
                navbar.classList.add('glass-header-scrolled');
                navbar.classList.remove('glass-header-top');
                if(logoIcon) { logoIcon.classList.remove('bg-white', 'text-brand-dark'); logoIcon.classList.add('bg-brand-dark', 'text-white'); }
                if(logoImg) { logoImg.classList.remove('invert'); }
                if(logoText) { logoText.classList.remove('text-white'); logoText.classList.add('text-brand-dark'); }
                if(logoSubtext) { logoSubtext.classList.remove('text-slate-300'); logoSubtext.classList.add('text-slate-500'); }
                navLinks.forEach(link => { link.classList.remove('text-white'); link.classList.add('text-brand-main'); });
                dividers.forEach(div => { div.classList.remove('bg-white/20'); div.classList.add('bg-brand-border'); });
            } else {
                navbar.classList.remove('glass-header-scrolled');
                navbar.classList.add('glass-header-top');
                if(logoIcon) { logoIcon.classList.add('bg-white', 'text-brand-dark'); logoIcon.classList.remove('bg-brand-dark', 'text-white'); }
                if(logoImg) { logoImg.classList.add('invert'); }
                if(logoText) { logoText.classList.add('text-white'); logoText.classList.remove('text-brand-dark'); }
                if(logoSubtext) { logoSubtext.classList.add('text-slate-300'); logoSubtext.classList.remove('text-slate-500'); }
                navLinks.forEach(link => { link.classList.add('text-white'); link.classList.remove('text-brand-main'); });
                dividers.forEach(div => { div.classList.add('bg-white/20'); div.classList.remove('bg-brand-border'); });
            }
        }

        function initHeaderListeners() {
            window.addEventListener('scroll', updateHeader);
            updateHeader(); 
        }
        
        // --- MAIN INIT ---
        function init() {
            const els = getEls();
            els.loanRange.addEventListener('input', (e) => updateLoan(parseInt(e.target.value)));
            els.ownRange.addEventListener('input', (e) => updateOwn(parseInt(e.target.value)));
            els.loanInput.addEventListener('change', (e) => updateLoan(parseCurrency(e.target.value)));
            els.ownInput.addEventListener('change', (e) => updateOwn(parseCurrency(e.target.value)));
            els.termRange.addEventListener('input', (e) => {
                state.term = parseInt(e.target.value);
                els.termDisplay.innerText = state.term;
                calculate();
            });
            initHeaderListeners();
            switchProduct('mortgage');
            // Mobile menu toggle
            const btn = document.getElementById('mobile-menu-btn');
            const menu = document.getElementById('mobile-menu');
            if (btn && menu) {
                btn.addEventListener('click', () => menu.classList.toggle('hidden'));
                document.querySelectorAll('#mobile-menu a[href^="/"]').forEach(anchor => {
                    anchor.addEventListener('click', () => menu.classList.add('hidden'));
                });
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
    <script src="../assets/js/main.js"></script>
</body>
</html>
