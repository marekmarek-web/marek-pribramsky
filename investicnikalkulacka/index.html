<!DOCTYPE html>
<html lang="cs" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Investiční kalkulačka | Marek Příbramský – Premium Brokers</title>
    
    <!-- Potřebné knihovny -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js & ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="icon" type="image/png" href="../assets/img/logos/pb-logo-no-bg.png">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <!-- Konfigurace Tailwindu -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            50: '#f8fafc',
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        brand: {
                            navy: '#1D2354',
                            navyLight: '#2a3366',
                            dark: '#0a0f29',
                            cyan: '#4FC6F2',
                            gold: '#fbbf24',
                            lightgold: '#fde047',
                            darkgold: '#d97706',
                            main: '#1D2354',
                            light: '#EAF3FF',
                            border: '#D6E6FF',
                            background: '#F8FAFC',
                            text: '#0F172A',
                            muted: '#475569',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    keyframes: {
                        shimmer: {
                            '0%': { transform: 'skewX(-20deg) translateX(-150%)' },
                            '100%': { transform: 'skewX(-20deg) translateX(150%)' }
                        },
                        scroll: {
                            '0%': { transform: 'translateX(0)' },
                            '100%': { transform: 'translateX(-50%)' }
                        }
                    },
                    animation: {
                        shimmer: 'shimmer 2.5s infinite',
                        scroll: 'scroll 40s linear infinite', 
                    }
                }
            }
        }
    </script>

    <style>
        /* Glass Effect Classes */
        .glass-header-top {
            background-color: #0a0f29;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-header-scrolled {
            background-color: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(11, 58, 122, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        }

        /* Odkaz v menu */
        .nav-link {
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            padding: 0.6rem 1rem;
            border-radius: 9999px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
        }

        /* --- STYLY PRO KALKULAČKU --- */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #4FC6F2;
            border: 3px solid #fff;
            cursor: pointer;
            margin-top: -10px;
            box-shadow: 0 4px 6px rgba(79, 198, 242, 0.4);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 3px;
        }
        input[type=range]:focus {
            outline: none;
        }
        input[type=range]::-moz-range-thumb {
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #4FC6F2;
            border: 3px solid #fff;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(79, 198, 242, 0.4);
        }
        input[type=range]::-moz-range-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 3px;
        }

        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }

        /* ========================================= */
        /* FIX NEKONEČNÉHO PÁSU (ULTIMATE VERZE) */
        /* ========================================= */

        /* Nekonečný pás log – 2 sady, -50% = seamless loop (žádný skok) */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .animate-scroll {
            width: max-content;
            display: flex;
            flex-wrap: nowrap;
            align-items: center;
            will-change: transform;
            animation: scroll 50s linear infinite;
        }

        .partner-logo {
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            margin: 0 32px;
        }

        .partner-logo img {
            max-height: 70px;
            max-width: 160px;
            width: auto;
            object-fit: contain;
            filter: grayscale(100%);
            opacity: 0.8;
            transition: filter 0.3s ease, opacity 0.3s ease;
            user-select: none;
            -webkit-user-drag: none;
        }

        .partner-logo img:hover {
            filter: grayscale(0%);
            opacity: 1;
        }

        /* MOBILNÍ – všechny loga jedou, menší mezery */
        @media (max-width: 768px) {
            .animate-scroll { animation-duration: 35s; }
            .partner-logo { margin: 0 20px; height: 72px; }
            .partner-logo img { max-height: 48px; max-width: 120px; }
            main, section { padding-left: 0.75rem !important; padding-right: 0.75rem !important; }
            .max-w-5xl, .max-w-4xl { margin-left: 0.5rem !important; margin-right: 0.5rem !important; max-width: calc(100% - 1rem) !important; }
            .grid-cols-1.md\:grid-cols-2 { grid-template-columns: 1fr !important; }
            input[type=range] { min-height: 28px; touch-action: manipulation; }
            input, select { font-size: 16px !important; }
        }
        @supports (padding: env(safe-area-inset-bottom)) {
            #mobile-menu { padding-bottom: max(1rem, env(safe-area-inset-bottom)); }
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* ========== NEUROMORPHIC UI (kalkulačka – bez sekce Simulace historického vývoje) ========== */
        :root{
          /* Brand-aware neuromorphic (NE kopie vzoru) */
          --neu-bg-primary: #ffffff;              /* bílé karty */
          --neu-bg-secondary: #F3F7FF;            /* jemně do brand.light */
          --neu-shadow-dark: rgba(29, 35, 84, .14);  /* navy shadow */
          --neu-shadow-light: rgba(255,255,255,.95);
          --neu-border: rgba(214, 230, 255, .85);    /* brand.border */
          --neu-accent: #4FC6F2;                 /* brand.cyan */
          --neu-accent-2: #fbbf24;               /* brand.gold */
          --transition-fast: 150ms;
        }

        /* Raised / Inset povrchy */
        .neu-raised{
          background: linear-gradient(145deg, var(--neu-bg-primary), var(--neu-bg-secondary));
          box-shadow:
            10px 10px 20px var(--neu-shadow-dark),
            -10px -10px 20px var(--neu-shadow-light);
          border: 1px solid var(--neu-border);
        }

        .neu-raised-sm{
          box-shadow:
            6px 6px 12px var(--neu-shadow-dark),
            -6px -6px 12px var(--neu-shadow-light);
          border: 1px solid var(--neu-border);
        }

        .neu-inset{
          background: linear-gradient(145deg, var(--neu-bg-secondary), var(--neu-bg-primary));
          box-shadow:
            inset 6px 6px 12px rgba(29, 35, 84, .12),
            inset -6px -6px 12px rgba(255,255,255,.9);
          border: 1px solid rgba(214, 230, 255, .9);
        }

        .neu-flat{
          background: linear-gradient(145deg, var(--neu-bg-primary), var(--neu-bg-secondary));
        }

        .neu-btn{
          transition: transform var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast);
        }
        .neu-btn:hover:not(:disabled){ transform: translateY(-2px); filter: brightness(1.02); }
        .neu-btn:active:not(:disabled){
          transform: translateY(1px);
          box-shadow:
            inset 3px 3px 6px rgba(29, 35, 84, .18),
            inset -3px -3px 6px rgba(255,255,255,.9);
        }

        /* Focus (brand navy) */
        .neu-focus:focus{ outline: none; }
        .neu-focus:focus-visible{ outline: 2px solid #1D2354; outline-offset: 2px; }

        /* Range slider – jen .neu-range (NIKDY ne #startYearInput v backtestu) */
        input[type=range].neu-range{
          -webkit-appearance:none;
          width:100%;
          height: 12px;
          border-radius: 9999px;
          /* default fill (JS to přepíše dynamicky) */
          background: linear-gradient(90deg, var(--neu-accent) 0%, var(--neu-accent) 0%, rgba(148,163,184,.35) 0%, rgba(148,163,184,.35) 100%);
          box-shadow:
            inset 4px 4px 8px rgba(29, 35, 84, .12),
            inset -4px -4px 8px rgba(255,255,255,.9);
        }

        input[type=range].neu-range::-webkit-slider-thumb{
          -webkit-appearance:none;
          width: 26px;
          height: 26px;
          border-radius: 9999px;
          background: radial-gradient(circle at 30% 30%, #ffffff 0%, #F3F7FF 45%, #EAF3FF 100%);
          border: 2px solid rgba(79,198,242,.35);
          box-shadow:
            6px 6px 12px rgba(29, 35, 84, .18),
            -6px -6px 12px rgba(255,255,255,.9);
          cursor:pointer;
          margin-top: -7px;
          transition: transform .12s ease;
        }
        input[type=range].neu-range::-webkit-slider-thumb:hover{ transform: scale(1.07); }

        input[type=range].neu-range::-moz-range-thumb{
          width:26px;height:26px;border-radius:9999px;border:none;
          background: radial-gradient(circle at 30% 30%, #ffffff 0%, #F3F7FF 45%, #EAF3FF 100%);
          box-shadow:
            6px 6px 12px rgba(29, 35, 84, .18),
            -6px -6px 12px rgba(255,255,255,.9);
          cursor:pointer;
        }

        input[type=range].neu-range::-moz-range-track{
          height:12px;border-radius:9999px;
          background: rgba(148,163,184,.35);
          box-shadow:
            inset 4px 4px 8px rgba(29, 35, 84, .12),
            inset -4px -4px 8px rgba(255,255,255,.9);
        }
        .lead-cta-btn {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            border: 1px solid rgba(22, 163, 74, 0.45);
            box-shadow: 0 10px 24px rgba(22, 163, 74, 0.28), inset 0 1px 0 rgba(255,255,255,0.28);
        }
        .lead-cta-btn:hover:not(:disabled) {
            filter: brightness(1.04);
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%) !important;
        }
        .lead-cta-btn:disabled {
            opacity: 0.75;
            cursor: not-allowed;
        }
        .profile-tab {
            border: 1px solid var(--neu-border);
            background: linear-gradient(145deg, #ffffff, #f3f7ff);
            box-shadow: 5px 5px 10px rgba(29, 35, 84, 0.12), -5px -5px 10px rgba(255,255,255,0.95);
            color: #475569;
        }
        .profile-tab:hover {
            color: #1D2354;
        }
        .profile-tab.bg-brand-navy {
            background: linear-gradient(145deg, #1D2354, #2a3366) !important;
            border-color: rgba(79, 198, 242, 0.35);
            box-shadow: inset 3px 3px 8px rgba(10, 15, 41, 0.45), inset -2px -2px 6px rgba(79, 198, 242, 0.18);
        }
        .profile-tab.bg-brand-navy:hover {
            color: #fff !important;
        }
        .accordion-panel { overflow: hidden; transition: max-height 0.3s ease-out; }
        @media (prefers-reduced-motion: reduce) {
            .neu-btn:hover:not(:disabled), .neu-btn:active:not(:disabled) { transform: none; }
        }

        .faq-card {
            border: none;
            background: linear-gradient(145deg, var(--neu-bg-primary), var(--neu-bg-secondary));
            box-shadow: 4px 4px 8px var(--neu-shadow-dark), -4px -4px 8px var(--neu-shadow-light);
            transition: box-shadow 0.3s;
        }
        .faq-card:hover {
            box-shadow: 6px 6px 12px var(--neu-shadow-dark), -6px -6px 12px var(--neu-shadow-light);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #0B3A7A; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #082855; }

    </style>
</head>
<body class="bg-brand-light font-sans text-slate-800 antialiased overflow-x-hidden page-loaded">

    <!-- Header PB (Marek Příbramský) -->
  <header id="main-header" class="header-entry fixed top-0 left-0 right-0 z-50 transform -translate-y-full transition-transform duration-500 ease-out" role="banner">
  <div class="header-inner max-w-6xl mx-auto px-4 pt-4 pb-2">
    <div class="header-glass rounded-full border border-slate-300/60 shadow-sm px-3 py-2 flex justify-between items-center gap-3">
      <a href="https://www.marekpribramsky.cz/" class="flex items-center gap-2 rounded-full bg-white/80 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-white/90 transition-colors focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1 shrink-0" aria-label="Úvodní stránka">
        <img src="../assets/img/logos/pb-logo-no-bg.png" alt="Premium Brokers" class="h-8 w-auto" />
      </a>
      <button id="mobile-menu-btn" type="button" class="hamburger-btn md:hidden flex items-center justify-center w-11 h-11 rounded-full text-slate-700 hover:bg-slate-100 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40" aria-label="Otevřít menu" aria-expanded="false" aria-controls="mobile-menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
      <nav id="mobile-menu" class="mobile-nav-drawer fixed inset-0 z-40 md:hidden" aria-label="Mobilní navigace" aria-hidden="true">
        <div class="mobile-nav-backdrop absolute inset-0 bg-black/40 backdrop-blur-sm" data-close-menu aria-hidden="true"></div>
        <div class="mobile-nav-panel absolute top-0 right-0 w-full max-w-sm h-full bg-white shadow-2xl flex flex-col pt-20 px-6 pb-8">
          <a href="https://www.marekpribramsky.cz/#proc-ja" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">O mně</a>
          <a href="https://www.marekpribramsky.cz/#sluzby" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Služby</a>
          <a href="https://www.marekpribramsky.cz/#spoluprace" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Spolupráce</a>
          <a href="https://www.marekpribramsky.cz/kalkulacky" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Kalkulačky</a>
          <a href="https://www.marekpribramsky.cz/blog" class="mobile-nav-link py-3 text-lg font-medium text-slate-800 border-b border-slate-100">Blog</a>
          <a href="https://www.marekpribramsky.cz/kontakt" class="mobile-nav-link mt-4 py-4 rounded-xl bg-[#1D2354] text-white font-semibold text-center">Kontaktujte mě</a>
        </div>
      </nav>
      <nav class="hidden md:flex items-center gap-1" aria-label="Hlavní navigace">
        <a href="https://www.marekpribramsky.cz/#proc-ja" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">O mně</a>
        <a href="https://www.marekpribramsky.cz/#sluzby" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Služby</a>
        <a href="https://www.marekpribramsky.cz/#spoluprace" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Spolupráce</a>
        <div class="relative group" aria-haspopup="true">
          <button type="button" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">
            Nástroje
            <svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 w-72 rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-xl shadow-lg p-2 invisible opacity-0 translate-y-1 group-hover:visible group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-200 z-50">
            <a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Hypoteční kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Měsíční splátka a náklady</span></a>
            <a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Investiční kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Projekce zhodnocení</span></a>
            <a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Kalkulačka životního pojištění</span><span class="block text-xs text-slate-500 mt-0.5">Potřebné krytí</span></a>
            <a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition"><span class="font-medium text-slate-800">Penzijní kalkulačka</span><span class="block text-xs text-slate-500 mt-0.5">Státní příspěvky</span></a>
            <div class="border-t border-slate-100 mt-2 pt-2"><a href="https://www.marekpribramsky.cz/kalkulacky" class="block rounded-xl px-3 py-2.5 hover:bg-slate-50 transition font-semibold text-[#1D2354]">Všechny kalkulačky →</a></div>
          </div>
        </div>
        <a href="https://www.marekpribramsky.cz/blog" class="rounded-full px-3 py-2 text-sm font-medium text-slate-700 hover:bg-white/60 hover:text-slate-900 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1">Blog</a>
      </nav>
      <a href="https://www.marekpribramsky.cz/kontakt" class="header-cta flex items-center justify-center gap-2 rounded-full bg-[#1D2354] text-white px-4 py-2 text-sm font-semibold hover:opacity-95 transition focus:outline-none focus:ring-2 focus:ring-[#4FC6F2]/40 focus:ring-offset-1 shrink-0">
        <span>Kontaktujte mě</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 17L17 7M17 7H7M17 7v10"/></svg>
      </a>
    </div>
  </div>
</header>

<main class="main-with-header">
    <!-- === HLAVNÍ OBSAH KALKULAČKY (ZAČÁTEK) === -->
    <section id="invest-kalkulacka" class="bg-brand-light py-10 px-4 md:py-20 container-padding">
            <div class="max-w-7xl mx-auto">

                <!-- HLAVIČKA SEKCE – stejné rozložení a styly jako Hypoteční kalkulačka -->
                <div class="hero-banner-calc bg-brand-light rounded-3xl p-8 md:p-12 mb-10 shadow-xl border border-brand-border/60 relative overflow-hidden">
                    <div class="absolute inset-0 overflow-hidden rounded-3xl pointer-events-none select-none">
                        <img src="../assets/img/logos/pb-logo-no-bg.png" alt="" aria-hidden="true"
                            class="absolute -bottom-24 -right-24 w-[32rem] max-w-[58%] h-auto opacity-20">
                    </div>
                    <div class="relative z-10 flex flex-col lg:flex-row justify-between items-start gap-8">
                        <div class="flex-1">
                            <h1 class="text-3xl md:text-5xl font-extrabold mb-4 leading-tight text-brand-navy">
                                Investiční kalkulačka – výpočet<br>
                                <span class="text-brand-navy">hodnoty investice v čase</span>
                            </h1>
                            <p class="text-slate-600 text-lg mb-8 max-w-2xl leading-relaxed">
                                Spočítejte si orientačně, jak se může vyvíjet vaše pravidelná investice v čase podle zvolené strategie.
                                Výsledky slouží jako podklad pro další plánování.
                            </p>

                            <!-- Profile Switcher – stejný styl jako hypo pill (světlé pozadí, aktivní navy) -->
                            <div class="flex flex-col gap-4">
                                <label class="text-xs font-bold text-slate-600 uppercase tracking-widest">Vyberte strategii</label>
                                <div class="inline-flex bg-white/80 p-1.5 rounded-xl border border-brand-border w-fit flex-wrap gap-1">
                                    <button class="profile-tab active px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 bg-white text-brand-navy shadow-md border border-brand-border flex items-center gap-2" data-profile="0" onclick="switchProfile(0)">
                                        <i class="fas fa-shield-alt"></i> Konzervativní
                                    </button>
                                    <button class="profile-tab px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 text-slate-600 hover:bg-white hover:text-brand-navy" data-profile="1" onclick="switchProfile(1)">
                                        <i class="fas fa-balance-scale"></i> Vyvážená
                                    </button>
                                    <button class="profile-tab px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 text-slate-600 hover:bg-white hover:text-brand-navy" data-profile="2" onclick="switchProfile(2)">
                                        <i class="fas fa-bolt"></i> Dynamická
                                    </button>
                                </div>
                                <p class="text-sm text-slate-500 mt-2">Předpokládaný výnos: <span id="headerRateDisplay" class="font-bold text-brand-navy">7</span>% p.a. (<span id="headerProfileName" class="font-medium">Vyvážený profil</span>)</p>
                            </div>
                        </div>

                        <!-- Google badge (jediný badge – stejně jako u Hypoteční) -->
                        <div class="flex flex-col gap-3 min-w-[240px]">
                            <a href="https://www.google.com/search?q=premium+brokers+roudnice" target="_blank" rel="noopener noreferrer" class="review-badge bg-white rounded-xl py-3 px-4 shadow-lg flex items-center gap-4 group no-underline text-slate-800">
                                <div class="bg-white p-1.5 rounded-full border border-slate-100 shrink-0">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg" alt="Google" class="w-5 h-5">
                                </div>
                                <div>
                                    <div class="flex items-center gap-1.5 mb-0.5">
                                        <span class="font-bold text-lg">4,9</span>
                                        <div class="flex text-yellow-400 text-xs" aria-hidden="true">
                                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        </div>
                                        <span class="text-xs text-slate-400">(45)</span>
                                    </div>
                                    <div class="text-xs font-semibold text-slate-500 group-hover:text-brand-navy transition-colors">Zobrazit recenze</div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- INFO CARD -->
                <div class="mt-8 mb-10 max-w-7xl mx-auto px-4">
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-base font-bold text-[#0a0f29] mb-3 flex items-center gap-2">
                            <i class="fas fa-info-circle w-4 h-4 text-brand-cyan"></i>
                            Informace ke kalkulaci
                        </h3>
                        <div class="text-slate-600 space-y-2 leading-relaxed text-xs md:text-sm">
                            <p>
                                Tato kalkulačka slouží k orientačnímu výpočtu, jak se může vyvíjet hodnota vaší investice v čase při pravidelném investování.
                                Zohledňuje výši počátečního vklad, měsíční investici, investiční horizont a zvolenou strategii.
                            </p>
                            <p>
                                Výsledkem je přehledná projekce budoucí hodnoty investice a celkového zhodnocení.
                                Kalkulačka pracuje s dlouhodobým pohledem a principem složeného úročení.
                            </p>
                            <p>
                                Výpočty jsou orientační a nezohledňují individuální daňové či legislativní aspekty.
                            </p>
                            <p>
                                Slouží jako podklad pro pochopení rozdílů mezi jednotlivými strategiemi a pro další rozhodování.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 1: VSTUPY A VÝSLEDKY (VEDLE SEBE) -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start mt-10">

                    <!-- LEVÁ ČÁST: VSTUPY -->
                    <div class="lg:col-span-7 neu-raised rounded-3xl p-6 md:p-8">
                        
                        <!-- 1. Počáteční vklad -->
                        <div class="mb-8">
                            <div class="flex justify-between items-end mb-4">
                                <label class="text-sm font-bold text-slate-600 tracking-wide">
                                    <span class="uppercase">Počáteční vklad</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>
                                </label>
                                <input type="text" id="initialDepositDisplay" class="neu-inset neu-focus bg-transparent rounded-xl text-right font-extrabold text-3xl text-brand-dark w-56 p-2 transition-colors border-0" value="100 000">
                            </div>
                            <input type="range" id="initialRange" min="0" max="2000000" step="10000" value="100000" class="w-full neu-range">
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>0 Kč</span>
                                <span>2 mil.</span>
                            </div>
                        </div>

                        <!-- 2. Pravidelná měsíční investice -->
                        <div class="mb-8">
                            <div class="flex justify-between items-end mb-4">
                                <label class="text-sm font-bold text-slate-600 tracking-wide">
                                    <span class="uppercase">Měsíční investice</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>
                                </label>
                                <input type="text" id="monthlyDepositDisplay" class="neu-inset neu-focus bg-transparent rounded-xl text-right font-extrabold text-3xl text-brand-dark w-56 p-2 transition-colors border-0" value="5 000">
                            </div>
                            <input type="range" id="monthlyRange" min="500" max="50000" step="500" value="5000" class="w-full neu-range">
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>500 Kč</span>
                                <span>50 tis.</span>
                            </div>
                        </div>

                        <!-- 3. Doba investice -->
                        <div>
                            <label class="block text-sm font-bold text-slate-600 mb-4 uppercase tracking-wide">Doba investice</label>
                            <div class="flex items-center gap-4">
                                <input type="range" id="yearsRange" min="3" max="30" step="1" value="10" class="flex-1 neu-range">
                                <div class="neu-inset rounded-xl px-4 py-2 font-bold text-brand-dark min-w-[80px] text-center">
                                    <span id="yearsDisplay">10</span> let
                                </div>
                            </div>
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>3 roky</span>
                                <span>30 let</span>
                            </div>
                        </div>

                        <!-- Info Box -->
                        <div class="mt-8 bg-blue-50/50 border border-blue-100/50 rounded-xl p-4 flex items-start gap-3">
                            <i class="fas fa-info-circle text-brand-main mt-1"></i>
                            <div class="text-sm text-slate-600">
                                <strong class="block text-brand-dark mb-1" id="profileTitleDesc">Vyvážený investor</strong>
                                <span id="profileDesc">Zlatá střední cesta. Kombinace stability dluhopisů a růstového potenciálu akcií.</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRAVÁ ČÁST: VÝSLEDKY -->
                    <div class="lg:col-span-5">
                        <div class="bg-brand-dark text-white rounded-2xl shadow-2xl shadow-brand-dark/30 border border-slate-800 p-8 overflow-hidden relative h-full flex flex-col justify-between">
                            <div class="absolute top-0 right-0 w-48 h-48 bg-brand-main opacity-20 rounded-full blur-2xl -mr-10 -mt-10"></div>
                            <div class="absolute bottom-0 left-0 w-32 h-32 bg-brand-cyan opacity-10 rounded-full blur-xl -ml-10 -mb-10"></div>

                            <div>
                                <h3 class="text-slate-400 font-medium mb-2 relative z-10 text-sm uppercase tracking-wider">Předpokládaná hodnota</h3>
                                <div class="flex items-baseline gap-2 mb-6 relative z-10">
                                    <span id="totalBalance" class="text-4xl md:text-5xl font-black text-white tracking-tight">--</span>
                                    <span class="text-2xl font-medium text-slate-500">Kč</span>
                                </div>

                                <div class="space-y-0 relative z-10 bg-slate-800/50 rounded-xl p-1 backdrop-blur-sm border border-white/5">
                                    <div class="flex justify-between items-center p-4 border-b border-white/10">
                                        <span class="text-slate-300 text-sm">Váš vklad</span>
                                        <span class="font-bold text-white text-lg" id="totalInvested">-- Kč</span>
                                    </div>
                                    <div class="flex justify-between items-center p-4 border-b border-white/10">
                                        <span class="text-slate-300 text-sm">Zisk z investice</span>
                                        <span class="font-bold text-green-400 text-lg" id="totalGain">-- Kč</span>
                                    </div>
                                    <div class="flex justify-between items-center p-4">
                                        <span class="text-slate-300 text-sm">Zhodnocení</span>
                                        <span class="font-bold text-brand-cyan text-lg" id="totalGainPercent">-- %</span>
                                    </div>
                                </div>
                                
                                <!-- Vysvětlující věta pod čísly -->
                                <p class="text-[11px] text-slate-400 mt-4 leading-normal opacity-70 relative z-10">
                                    Výsledky vycházejí z modelového výpočtu a slouží pro ilustraci dlouhodobého vývoje investice.
                                </p>
                            </div>

                            <div class="mt-8 relative z-10">
                                <button onclick="openModal()" class="lead-cta-btn neu-btn group relative w-full py-5 px-6 rounded-xl transition-all overflow-hidden">
                                    <div class="relative flex items-center justify-center gap-3 text-white font-extrabold text-lg">
                                        <span>Chci investiční plán</span>
                                        <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                                    </div>
                                </button>
                                <p class="text-xs text-slate-500 mt-4 text-center leading-relaxed opacity-60">
                                    Historické výnosy nejsou zárukou budoucích. Výpočty jsou orientační.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 2: GRAFY PROJEKCE A SLOŽENÍ (VEDLE SEBE) -->
                <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <!-- Graf 1: Projekce -->
                    <div class="neu-raised rounded-3xl p-6 flex flex-col text-center">
                        <h3 class="text-lg font-bold text-brand-dark flex items-center justify-center gap-2 mb-4">
                            <i class="fas fa-chart-line text-brand-cyan"></i>
                            Projekce vývoje
                        </h3>
                        <div class="flex-1 min-h-[300px] chart-container">
                            <canvas id="growthChart"></canvas>
                        </div>
                        <!-- Vysvětlující věta pod grafem -->
                        <p class="text-xs text-slate-500 mt-4 italic">
                            Graf ukazuje odhadovaný vývoj hodnoty investice v čase při pravidelném investování a zvolené strategii.
                        </p>
                    </div>

                    <div class="neu-raised rounded-3xl p-6 flex flex-col text-center">
                        <h3 class="text-lg font-bold text-brand-dark flex items-center justify-center gap-2 mb-4">
                            <i class="fas fa-chart-pie text-brand-cyan"></i>
                            Složení portfolia
                        </h3>
                        <div class="flex-1 flex flex-col justify-center items-center gap-6">
                            <div class="relative h-56 w-56">
                                <canvas id="allocationChart"></canvas>
                            </div>
                            <div id="allocationLegend" class="w-full max-w-xs space-y-2">
                                <!-- JS injected legend -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 3: BACKTEST GRAF (FULL WIDTH) -->
                <div class="mt-12 bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden">
                    <div class="p-6 md:p-10 border-b border-slate-100">
                        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-4">
                            <div>
                                <h3 class="text-2xl md:text-3xl font-bold text-brand-dark flex items-center gap-3">
                                    <i class="fas fa-history text-brand-cyan"></i>
                                    Simulace historického vývoje
                                </h3>
                                <p class="text-slate-600 mt-2 text-lg">
                                    Jak by dopadla vaše investice <span id="backtestMonthlyLabel" class="font-bold text-brand-main">-- Kč</span> měsíčně, kdybyste začali v roce <span id="startYearLabelDisplay" class="font-bold text-brand-main">--</span>?
                                </p>
                            </div>
                            <div class="flex items-center gap-2 text-xs font-bold uppercase tracking-wider bg-green-50 text-green-700 px-4 py-2 rounded-full border border-green-100">
                                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                                Reálná tržní data 1995–2024
                            </div>
                        </div>
                        
                        <!-- Kontextová věta Backtest -->
                        <p class="text-sm text-slate-500 leading-relaxed max-w-3xl">
                            Historická simulace ukazuje, jak by se investice vyvíjela při zachování dlouhodobé strategie i v obdobích krizí a poklesů trhu.
                        </p>
                    </div>
                    
                    <div class="p-6 md:p-10">
                         <!-- Backtest Chart -->
                         <div id="backtestChart" class="w-full h-[500px]"></div>
                         
                         <!-- Year Slider Control -->
                         <div class="mt-10 bg-slate-50 rounded-2xl p-6 border border-slate-100">
                             <div class="flex justify-between items-center mb-4">
                                 <span class="text-sm font-bold text-slate-500 uppercase tracking-wider">Posunout v čase (Start investice)</span>
                                 <span class="text-lg font-bold text-brand-dark bg-white px-4 py-2 rounded-lg shadow-sm border border-slate-200" id="startYearDisplay">Rok 1995</span>
                             </div>
                             <input type="range" id="startYearInput" min="1995" max="2019" step="1" value="1995" class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer neu-range">
                             <div class="flex justify-between text-xs font-bold text-slate-400 mt-3 uppercase tracking-wide">
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>1995 (Dot-com)</span>
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>2008 (Krize)</span>
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>2019 (Covid)</span>
                             </div>
                         </div>
                    </div>
                </div>
                
                <!-- SEKCE FAQ -->
                <div class="mt-12 lg:col-span-12 px-0 sm:px-4">
                    <h2 class="text-2xl sm:text-3xl font-bold text-brand-dark mb-8 text-center uppercase tracking-widest">FAQ – Investiční kalkulačka</h2>
                    
                    <div id="faq-container" class="space-y-4 max-w-4xl mx-auto">
                        <!-- JS will render FAQ here -->
                    </div>
                </div>

                <!-- ZÁVĚREČNÁ CTA (INVESTIČNÍ PLÁN) – zarovnáno s FAQ (max-w-4xl) -->
                <div class="mt-12 lg:col-span-12 max-w-4xl mx-auto px-0 sm:px-4">
                    <div class="bg-gradient-to-r from-brand-navy to-brand-navyLight rounded-3xl p-6 sm:p-8 md:p-12 text-white shadow-2xl relative overflow-hidden text-center">
                        <div class="absolute top-0 right-0 w-48 h-48 bg-brand-cyan opacity-10 rounded-full blur-2xl -mr-10 -mt-10"></div>
                        <div class="absolute bottom-0 left-0 w-32 h-32 bg-brand-cyan opacity-10 rounded-full blur-xl -ml-10 -mb-10"></div>

                        <h2 class="text-2xl sm:text-3xl font-extrabold text-white mb-4 relative z-10">Chcete investiční plán přizpůsobený vaší situaci?</h2>
                        <p class="text-base sm:text-lg text-blue-100 max-w-3xl mx-auto mb-6 sm:mb-8 relative z-10">
                            Výsledek z kalkulačky může sloužit jako základ pro sestavení konkrétní investiční strategie podle vašich cílů, příjmů a časového horizontu.
                        </p>
                        <button onclick="openModal()" class="lead-cta-btn neu-btn group relative inline-block w-full sm:w-auto py-4 sm:py-5 px-6 sm:px-8 rounded-xl transition-all overflow-hidden no-underline text-center text-white font-extrabold text-base sm:text-lg">
                            <span class="inline-flex items-center gap-3">
                                Chci investiční plán
                                <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                            </span>
                        </button>
                    </div>
                </div>

                <!-- Spočítejte si sami – stejný styl jako Moje služby na main indexu -->
                <div class="max-w-7xl mx-auto mt-20 mb-20 pt-10 border-t border-brand-border/50 lg:col-span-12">
                    <h3 class="text-2xl font-bold text-brand-navy mb-8 text-center">Spočítejte si sami</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
                        <a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Hypoteční kalkulačka</h3>
                                        <p class="text-brand-muted text-sm">Financování bydlení</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Srovnání hypoték a úvěrů bez kontaktu.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/></svg>Hypoteční kalkulačka</span>
                            </div>
                        </a>
                        <a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Penzijní kalkulačka</h3>
                                        <p class="text-brand-muted text-sm">Státní důchod a úspory</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Realita důchodů a nutné spoření.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>Penzijní kalkulačka</span>
                            </div>
                        </a>
                        <a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="sluzby-card-glass group block">
                            <div class="sluzby-glass-inner">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-14 h-14 rounded-2xl bg-white/30 backdrop-blur-md border border-white/40 flex items-center justify-center shrink-0 group-hover:scale-110 group-hover:bg-white/50 transition-all duration-300 sluzby-icon-glass">
                                        <svg class="w-7 h-7 text-brand-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-brand-text mb-1">Životní pojištění</h3>
                                        <p class="text-brand-muted text-sm">Krytí pro rodinu</p>
                                    </div>
                                </div>
                                <p class="text-brand-muted text-sm leading-relaxed mb-6">Výpočet potřebného krytí.</p>
                                <span class="sluzby-cta-glass inline-flex items-center gap-2"><svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"/></svg>Kalkulačka pojištění</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- PARTNEŘI / LOGA – nekonečný pás (2 sady = seamless loop) -->
                <div class="mt-24 pt-10 border-t border-brand-border/50 overflow-hidden marquee-container relative opacity-80 hover:opacity-100 transition-opacity lg:col-span-12" aria-hidden="true">
                    <div class="flex overflow-hidden py-4" style="mask-image: linear-gradient(90deg, transparent 0%, black 5%, black 95%, transparent 100%); -webkit-mask-image: linear-gradient(90deg, transparent 0%, black 5%, black 95%, transparent 100%);">
                        <div class="animate-scroll" style="display: flex; flex-wrap: nowrap; width: max-content;">
                            <!-- SADA 1 -->
                            <div class="partner-logo"><img src="../assets/img/creif-logo.png" alt="Creif"></div>
                            <div class="partner-logo"><img src="../assets/img/amundi-logo.png" alt="Amundi"></div>
                            <div class="partner-logo"><img src="../assets/img/edward-logo.png" alt="Edward"></div>
                            <div class="partner-logo"><img src="../assets/img/investika-logo.png" alt="Investika"></div>
                            <div class="partner-logo"><img src="../assets/img/avant-logo.png" alt="Avant"></div>
                            <div class="partner-logo"><img src="../assets/img/conseq-logo.png" alt="Conseq"></div>
                            <div class="partner-logo"><img src="../assets/img/cyrrus-logo.png" alt="Cyrrus"></div>
                            <!-- SADA 2 (duplikát pro seamless loop) -->
                            <div class="partner-logo"><img src="../assets/img/creif-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/amundi-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/edward-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/investika-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/avant-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/conseq-logo.png" alt=""></div>
                            <div class="partner-logo"><img src="../assets/img/cyrrus-logo.png" alt=""></div>
                        </div>
                    </div>
                </div>
            </div> <!-- UZAVŘENÍ MAX-W-7XL -->
        </section> <!-- UZAVŘENÍ SEKCIE -->
    <!-- === HLAVNÍ OBSAH KALKULAČKY (KONEC) === -->

    <!-- KONTAKTNÍ MODAL -->
    <div id="contactModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-brand-dark/80 backdrop-blur-sm transition-opacity opacity-0" id="modalBackdrop"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-auto">
            <div class="neu-raised rounded-3xl w-full max-w-md transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto relative overflow-hidden" id="modalContent">
                <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-400 hover:text-brand-dark transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 z-10" type="button">
                    <i class="fas fa-times"></i>
                </button>
                <div class="neu-flat px-8 py-8 border-b border-slate-200/50">
                    <h3 class="text-2xl font-bold text-brand-dark uppercase tracking-wide">Mám zájem o plán</h3>
                    <p class="text-sm text-slate-600 mt-2 flex items-center gap-2">
                        <i class="fas fa-chart-line text-brand-cyan"></i>
                        <span>Strategie: <strong id="modalProfileName" class="text-brand-main">--</strong></span>
                    </p>
                </div>
                <div class="p-8">
                    <!-- CHANGE: Removed action/method from form tag to handle with JS -->
                    <form id="leadForm">
                        <div class="space-y-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1 uppercase tracking-tighter">E-mail <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <i class="fas fa-envelope absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="email" name="email" required placeholder="vas@email.cz" class="w-full neu-inset neu-focus bg-transparent rounded-xl pl-10 pr-4 py-3 border-0 outline-none transition-shadow">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1 uppercase tracking-tighter">Telefon <span class="text-slate-400 font-normal normal-case">(nepovinné)</span></label>
                                <div class="relative">
                                    <i class="fas fa-phone absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="tel" name="telefon" placeholder="+420 777 ..." class="w-full neu-inset neu-focus bg-transparent rounded-xl pl-10 pr-4 py-3 border-0 outline-none transition-shadow">
                                </div>
                            </div>
                            <div class="flex items-start gap-3 mt-2 neu-inset p-3 rounded-xl">
                                <input type="checkbox" id="consent" required class="mt-1 w-4 h-4 text-brand-cyan rounded border-slate-300 focus:ring-brand-cyan cursor-pointer">
                                <label for="consent" class="text-xs text-slate-600 cursor-pointer select-none">
                                    Souhlasím se zpracováním osobních údajů pro účely vytvoření investičního plánu.
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="lead-cta-btn neu-btn w-full mt-8 text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 text-lg">
                            <span>Odeslat nezávazně</span>
                            <i class="fas fa-paper-plane text-sm"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

</main>
    <!-- Footer PB (Marek Příbramský) -->
  <footer class="bg-brand-navy text-white py-10 sm:py-12 lg:py-16" role="contentinfo">
  <div class="footer-inner mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8 sm:gap-10 lg:gap-12 mb-8 sm:mb-10 lg:mb-12">
      <div class="md:col-span-2 lg:col-span-2">
        <div class="flex flex-col">
          <div class="flex items-center gap-2 mb-2">
            <a href="https://www.marekpribramsky.cz/" class="shrink-0">
              <img src="../assets/img/logos/pb-logo-no-bg-grey.png" alt="Premium Brokers" class="h-10 w-auto" />
            </a>
            <span class="font-bold text-xl">Marek Příbramský</span>
          </div>
          <p class="text-slate-300 text-sm max-w-sm mb-4">Privátní finanční plánování pro lidi, kteří chtějí mít klid. Pomáhám rodinám a podnikatelům sestavit strategie, které dávají smysl.</p>
          <span class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-2">Sledujte mě</span>
          <div class="flex flex-wrap gap-3 social-icons-row">
            <a href="https://www.facebook.com/PremiumBrokersRCE" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--fb social-icon-link" aria-label="Facebook"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
            <a href="https://www.instagram.com/premiumbrokers.cz/" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--ig social-icon-link" aria-label="Instagram"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg></a>
            <a href="https://www.linkedin.com/in/marek-pribramsky/" target="_blank" rel="noopener noreferrer" class="social-fa social-fa--li social-icon-link" aria-label="LinkedIn"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
          </div>
        </div>
      </div>
      <div><h4 class="font-bold text-sm uppercase tracking-wider mb-4">Rychlé odkazy</h4><ul class="space-y-2 text-sm"><li><a href="https://www.marekpribramsky.cz/#sluzby" class="text-slate-300 hover:text-white">Služby</a></li><li><a href="https://www.marekpribramsky.cz/#pobocky" class="text-slate-300 hover:text-white">Pobočky</a></li><li><a href="https://www.marekpribramsky.cz/blog" class="text-slate-300 hover:text-white">Blog</a></li><li><a href="https://www.marekpribramsky.cz/spoluprace" class="text-slate-300 hover:text-white">Spolupráce</a></li><li><a href="https://www.marekpribramsky.cz/kontakt" class="text-slate-300 hover:text-white">Kontakt</a></li></ul></div>
      <div><h4 class="font-bold text-sm uppercase tracking-wider mb-4">Nástroje</h4><ul class="space-y-2 text-sm"><li><a href="https://www.marekpribramsky.cz/hypotecnikalkulacka" class="text-slate-300 hover:text-white">Hypoteční kalkulačka</a></li><li><a href="https://www.marekpribramsky.cz/investicnikalkulacka" class="text-slate-300 hover:text-white">Investiční kalkulačka</a></li><li><a href="https://www.marekpribramsky.cz/zivotnikalkulacka" class="text-slate-300 hover:text-white">Životní pojištění</a></li><li><a href="https://www.marekpribramsky.cz/penzijnikalkulacka" class="text-slate-300 hover:text-white">Penzijní kalkulačka</a></li></ul></div>
      <div><h4 class="font-bold text-sm uppercase tracking-wider mb-4">Pobočky</h4><ul class="space-y-2 text-sm text-slate-300"><li><strong class="text-white">Roudnice nad Labem</strong><br>Nám. Jana z Dražic 99, 413 01</li><li><strong class="text-white">Štětí</strong><br>U Tržnice 701, 411 08</li><li><strong class="text-white">Litoměřice</strong><br>5. května 10, 412 01</li><li><strong class="text-white">Praha</strong><br>Žatecká 55/14, 110 00</li><li><strong class="text-white">Lovosice</strong><br><span class="text-slate-400">Brzy otevíráme</span></li></ul></div>
      <div><h4 class="font-bold text-sm uppercase tracking-wider mb-4">Kontakt</h4><ul class="space-y-3 text-sm text-slate-300"><li><a href="tel:+420728480423" class="hover:text-white">+420 728 480 423</a></li><li><a href="mailto:pribramsky@premiumbrokers.cz" class="hover:text-white">pribramsky@premiumbrokers.cz</a></li></ul></div>
    </div>
    <div class="border-t border-white/10 pt-8 space-y-4">
      <div class="flex flex-col sm:flex-row justify-between items-center gap-4 text-xs text-slate-400"><p>&copy; 2025 Marek Příbramský. Všechna práva vyhrazena.</p><div class="flex gap-6"><a href="https://www.beplan.cz/ochrana-osobnich-udaju/" target="_blank" rel="noopener noreferrer" class="hover:text-white">Ochrana osobních údajů</a><a href="https://www.marekpribramsky.cz/cookies" class="hover:text-white">Cookies</a></div></div>
      <p class="text-[10px] text-slate-500 leading-relaxed max-w-3xl">Ing. Marek Příbramský, IČO: 02024870 je vázaným zástupcem samostatného zprostředkovatele BEplan finanční plánování s.r.o., IČO: 05779944. Služby jsou poskytovány v rámci následujících registrací. Pojištění: vázaný zástupce podle zákona č. 170/2018 Sb., o distribuci pojištění a zajištění. Spotřebitelské úvěry: vázaný zástupce podle zákona č. 257/2016 Sb., o spotřebitelském úvěru. Investiční služby a produkty: vázaný zástupce podle zákona č. 256/2004 Sb., o podnikání na kapitálovém trhu. Doplňkové penzijní spoření: vázaný zástupce podle zákona č. 427/2011 Sb., o doplňkovém penzijním spoření.</p>
      <p class="text-sm text-slate-400">Vytvořil <a href="https://www.m2digitalagency.cz/" target="_blank" rel="noopener noreferrer" class="hover:text-white font-medium">M2DigitalAgency</a></p>
    </div>
  </div>
</footer>

    <!-- JAVASCRIPT LOGIKA -->
    <script>
        // --- HEADER LOGIC (SCROLL EFFECT & MOBILE MENU) ---
        document.addEventListener('DOMContentLoaded', function() {
            const navbar = document.getElementById('navbar');
            const logoIcon = document.getElementById('logo-icon');
            const logoText = document.getElementById('logo-text');
            const logoSubtext = document.getElementById('logo-subtext');
            const navLinks = document.querySelectorAll('.nav-link');
            const dividers = document.querySelectorAll('[id^="nav-divider"]');
            const logoImg = document.getElementById('logo-img');
            const mobileBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');

            function updateHeader() {
                if (!navbar) return;

                if (window.scrollY > 20) {
                    navbar.classList.add('glass-header-scrolled');
                    navbar.classList.remove('glass-header-top');
                    
                    if(logoIcon) {
                        logoIcon.classList.remove('bg-white', 'text-brand-dark');
                        logoIcon.classList.add('bg-brand-dark', 'text-white');
                    }
                    if(logoImg) logoImg.classList.remove('invert');
                    if(logoText) {
                        logoText.classList.remove('text-white');
                        logoText.classList.add('text-brand-dark');
                    }
                    if(logoSubtext) {
                        logoSubtext.classList.remove('text-slate-300');
                        logoSubtext.classList.add('text-slate-500');
                    }
                    navLinks.forEach(link => {
                        link.classList.remove('text-white');
                        link.classList.add('text-brand-main');
                        link.classList.add('hover:bg-brand-light');
                        link.classList.remove('hover:bg-white/10');
                        link.classList.remove('hover:backdrop-blur-md');
                    });
                    dividers.forEach(div => {
                        div.classList.remove('bg-white/20');
                        div.classList.add('bg-brand-border');
                    });

                } else {
                    navbar.classList.remove('glass-header-scrolled');
                    navbar.classList.add('glass-header-top');

                    if(logoIcon) {
                        logoIcon.classList.add('bg-white', 'text-brand-dark');
                        logoIcon.classList.remove('bg-brand-dark', 'text-white');
                    }
                    if(logoImg) logoImg.classList.add('invert');
                    if(logoText) {
                        logoText.classList.add('text-white');
                        logoText.classList.remove('text-brand-dark');
                    }
                    if(logoSubtext) {
                        logoSubtext.classList.add('text-slate-300');
                        logoSubtext.classList.remove('text-slate-500');
                    }
                    navLinks.forEach(link => {
                        link.classList.add('text-white');
                        link.classList.remove('text-brand-main');
                        link.classList.remove('hover:bg-brand-light');
                        link.classList.add('hover:bg-white/10');
                        link.classList.add('hover:backdrop-blur-md');
                    });
                    dividers.forEach(div => {
                        div.classList.add('bg-white/20');
                        div.classList.remove('bg-brand-border');
                    });
                }
            }

            window.addEventListener('scroll', updateHeader);
            updateHeader();

            if (mobileBtn && mobileMenu) {
                mobileBtn.addEventListener('click', () => { 
                    mobileMenu.classList.toggle('hidden'); 
                });
            }
        });

        // --- CALCULATOR LOGIC (KEEP UNTOUCHED) ---
        const profiles = [
            {
                id: 'konzervativni',
                name: 'Konzervativní investor',
                rate: 5,
                color: '#3b82f6', 
                description: 'Stabilní zhodnocení s minimálním kolísáním. Ideální pro opatrné investory. Využívá dluhopisy a nemovitostní fondy.',
                composition: [
                    { name: 'Dluhopisy', value: 70, color: '#3b82f6' },
                    { name: 'Nemovitostní fondy', value: 20, color: '#10b981' },
                    { name: 'Akcie', value: 10, color: '#f59e0b' },
                ]
            },
            {
                id: 'vyvazeny',
                name: 'Vyvážený investor',
                rate: 7,
                color: '#a855f7', 
                description: 'Zlatá střední cesta. Kombinace stability dluhopisů, růstového potenciálu akcií a jistoty nemovitostních fondů.',
                composition: [
                    { name: 'Akcie (ETF)', value: 50, color: '#f59e0b' },
                    { name: 'Dluhopisy', value: 35, color: '#3b82f6' },
                    { name: 'Nemovitostní fondy', value: 15, color: '#10b981' },
                ]
            },
            {
                id: 'dynamicky',
                name: 'Dynamický investor',
                rate: 9,
                color: '#eab308', 
                description: 'Maximální potenciál výnosu. Strategie pro dlouhodobé cíle.',
                composition: [
                    { name: 'Globální Akcie', value: 90, color: '#f59e0b' },
                    { name: 'Dluhopisy', value: 10, color: '#3b82f6' },
                ]
            }
        ];

        const historicalData = [
          { date: '1995-01', sp500: 459, gold: 380, bonds: 100, re: 100 },
          { date: '1996-06', sp500: 670, gold: 385, bonds: 108, re: 106 },
          { date: '1998-01', sp500: 970, gold: 290, bonds: 115, re: 112 },
          { date: '1999-12', sp500: 1469, gold: 290, bonds: 118, re: 120 },
          { date: '2001-09', sp500: 1040, gold: 290, bonds: 125, re: 128 },
          { date: '2002-10', sp500: 776, gold: 315, bonds: 135, re: 132 },
          { date: '2004-01', sp500: 1130, gold: 410, bonds: 138, re: 140 },
          { date: '2007-10', sp500: 1565, gold: 750, bonds: 145, re: 155 },
          { date: '2008-09', sp500: 1100, gold: 830, bonds: 148, re: 158 },
          { date: '2009-03', sp500: 676, gold: 920, bonds: 152, re: 156 },
          { date: '2010-06', sp500: 1030, gold: 1240, bonds: 158, re: 162 },
          { date: '2011-08', sp500: 1120, gold: 1820, bonds: 165, re: 168 },
          { date: '2013-01', sp500: 1498, gold: 1660, bonds: 170, re: 175 },
          { date: '2015-01', sp500: 2000, gold: 1280, bonds: 175, re: 185 },
          { date: '2018-09', sp500: 2900, gold: 1200, bonds: 178, re: 205 },
          { date: '2020-02', sp500: 3380, gold: 1550, bonds: 185, re: 215 },
          { date: '2020-03', sp500: 2300, gold: 1470, bonds: 180, re: 214 },
          { date: '2020-08', sp500: 3500, gold: 2060, bonds: 190, re: 218 },
          { date: '2021-12', sp500: 4766, gold: 1800, bonds: 185, re: 225 },
          { date: '2022-06', sp500: 3785, gold: 1810, bonds: 165, re: 228 },
          { date: '2022-10', sp500: 3580, gold: 1650, bonds: 155, re: 230 },
          { date: '2023-12', sp500: 4700, gold: 2040, bonds: 162, re: 245 },
          { date: '2024-04', sp500: 5200, gold: 2350, bonds: 164, re: 250 }
        ];

        let state = { initial: 100000, monthly: 5000, years: 10, profileIndex: 1, startYear: 1995 };
        let growthChartInstance = null, allocationChartInstance = null, backtestChartInstance = null, openFaq = null;

        const faqData = [
            { question: "Co je investiční kalkulačka a k čemu slouží?", answer: "Kalkulačka slouží k rychlému a orientačnímu výpočtu potenciální budoucí hodnoty vaší pravidelné investice na základě vámi zvolené strategie a investičního horizontu." },
            { question: "Jak investiční kalkulačka počítá výnosy?", answer: "Kalkulačka používá princip složeného úročení na základě průměrné roční výnosnosti (p.a.) při pravidelném měsíčním vkladu po celou dobu trvání investice." },
            { question: "Jsou uvedené výnosy garantované?", answer: "Nejsou. Výsledky jsou pouze orientační projekce založené na historických průměrech. Investování s sebou nese riziko, a minulé výnosy nezaručují výnosy budoucí." },
            { question: "Jaký je rozdíl mezi konzervativní, vyváženou a dynamickou strategií?", answer: "Konzervativní strategie preferuje stabilitu s nižším očekávaným výnosem. Dynamická strategie upřednostňuje růst s vyšším potenciálem, ale i vyšším rizikem kolísání." },
            { question: "Je kalkulačka vhodná pro dlouhodobé investování?", answer: "Ano, výpočty modelují dlouhé časové horizonty (3–30 let), což je v souladu s doporučeními pro efektivní investování do diverzifikovaných portfolií." },
            { question: "Mohu výsledek konzultovat s Vámi?", answer: "Určitě. Výsledek kalkulačky je ideálním výchozím bodem pro individuální konzultaci. Můžete si sjednat schůzku a probrat své konkrétní finanční cíle a rizika." }
        ];

        function getEls() {
            return {
                initialRange: document.getElementById('initialRange'), initialInput: document.getElementById('initialDepositDisplay'),
                monthlyRange: document.getElementById('monthlyRange'), monthlyInput: document.getElementById('monthlyDepositDisplay'),
                yearsRange: document.getElementById('yearsRange'), yearsDisplay: document.getElementById('yearsDisplay'),
                totalBalance: document.getElementById('totalBalance'), totalInvested: document.getElementById('totalInvested'),
                totalGain: document.getElementById('totalGain'), totalGainPercent: document.getElementById('totalGainPercent'),
                headerRate: document.getElementById('headerRateDisplay'), headerProfile: document.getElementById('headerProfileName'),
                profileTitleDesc: document.getElementById('profileTitleDesc'), profileDesc: document.getElementById('profileDesc'),
                allocationLegend: document.getElementById('allocationLegend'), backtestMonthlyLabel: document.getElementById('backtestMonthlyLabel'),
                startYearInput: document.getElementById('startYearInput'), startYearDisplay: document.getElementById('startYearDisplay'),
                startYearLabelDisplay: document.getElementById('startYearLabelDisplay'), faqContainer: document.getElementById('faq-container'),
                tabs: document.querySelectorAll('.profile-tab'), growthCanvas: document.getElementById('growthChart'),
                allocationCanvas: document.getElementById('allocationChart'), modal: document.getElementById('contactModal'),
                modalBackdrop: document.getElementById('modalBackdrop'), modalContent: document.getElementById('modalContent'),
                modalProfileName: document.getElementById('modalProfileName'),
            };
        }

        const formatCurrency = (num) => num.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        const parseCurrency = (str) => parseInt(str.replace(/\s/g, ''), 10) || 0;
        const CZECH_MONTHS = ['Leden', 'Únor', 'Březen', 'Duben', 'Květen', 'Červen', 'Červenec', 'Srpen', 'Září', 'Říjen', 'Listopad', 'Prosinec'];

        function applyNeuRangeFill(el){
            if(!el || !el.classList.contains('neu-range')) return;
            const min = Number(el.min ?? 0);
            const max = Number(el.max ?? 100);
            const val = Number(el.value ?? min);
            const pct = ((val - min) / (max - min)) * 100;

            // brand-aware fill: cyan -> navy hint
            el.style.background = `linear-gradient(90deg,
                rgba(79,198,242,1) 0%,
                rgba(79,198,242,1) ${pct}%,
                rgba(148,163,184,.35) ${pct}%,
                rgba(148,163,184,.35) 100%)`;
        }

        function renderFaq() {
            const els = getEls();
            if (!els.faqContainer) return;
            els.faqContainer.innerHTML = faqData.map((item, index) => `
                <div class="faq-card rounded-xl mb-4">
                    <button class="neu-focus w-full text-left py-4 px-6 flex justify-between items-center transition-colors hover:text-brand-cyan focus:outline-none rounded-xl" onclick="toggleFaq(${index})">
                        <h4 class="text-lg font-bold text-slate-900">${item.question}</h4>
                        <i id="faq-icon-${index}" class="fas fa-chevron-down text-sm transition-transform text-brand-main shrink-0 ml-4"></i>
                    </button>
                    <div id="faq-answer-${index}" class="pb-4 px-6 overflow-hidden transition-all duration-300 ease-in-out" style="max-height: 0; opacity: 0;">
                        <p class="text-slate-600 text-sm">${item.answer}</p>
                    </div>
                </div>`).join('');
        }

        function toggleFaq(index) {
            const newOpenFaq = openFaq === index ? null : index;
            if (openFaq !== null) {
                const prevAnswer = document.getElementById(`faq-answer-${openFaq}`);
                const prevIcon = document.getElementById(`faq-icon-${openFaq}`);
                if (prevAnswer) { prevAnswer.style.maxHeight = '0'; prevAnswer.style.opacity = '0'; }
                if (prevIcon) { prevIcon.classList.remove('rotate-180', 'text-brand-cyan'); prevIcon.classList.add('text-brand-main'); }
            }
            openFaq = newOpenFaq;
            if (openFaq !== null) {
                const currentAnswer = document.getElementById(`faq-answer-${openFaq}`);
                const currentIcon = document.getElementById(`faq-icon-${openFaq}`);
                if (currentAnswer) { currentAnswer.style.maxHeight = currentAnswer.scrollHeight + 50 + 'px'; currentAnswer.style.opacity = '1'; }
                if (currentIcon) { currentIcon.classList.add('rotate-180', 'text-brand-cyan'); currentIcon.classList.remove('text-brand-main'); }
            }
        }

        function switchProfile(index) {
            state.profileIndex = index;
            const els = getEls();
            els.tabs.forEach(t => {
                if(parseInt(t.dataset.profile) === index) {
                    t.classList.add('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    t.classList.remove('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                } else {
                    t.classList.remove('bg-white', 'text-brand-navy', 'shadow-md', 'border', 'border-brand-border');
                    t.classList.add('text-slate-600', 'hover:bg-white', 'hover:text-brand-navy');
                }
            });
            const p = profiles[index];
            els.headerRate.innerText = p.rate;
            els.headerProfile.innerText = p.name;
            els.profileTitleDesc.innerText = p.name;
            els.profileDesc.innerText = p.description;
            calculate();
        }

        function updateInputs(key, value) {
            state[key] = value;
            const els = getEls();
            if (key === 'initial') { els.initialInput.value = formatCurrency(state.initial); els.initialRange.value = state.initial; applyNeuRangeFill(els.initialRange); }
            else if (key === 'monthly') { els.monthlyInput.value = formatCurrency(state.monthly); els.monthlyRange.value = state.monthly; applyNeuRangeFill(els.monthlyRange); }
            else if (key === 'years') { els.yearsDisplay.innerText = state.years; applyNeuRangeFill(els.yearsRange); }
            else if (key === 'startYear') { els.startYearDisplay.innerText = 'Rok ' + state.startYear; if(els.startYearLabelDisplay) els.startYearLabelDisplay.innerText = state.startYear; applyNeuRangeFill(els.startYearInput); }
            calculate();
        }

        function calculate() {
            const els = getEls();
            const profile = profiles[state.profileIndex];
            let currentBalance = state.initial, totalInvested = state.initial;
            const labels = [], dataBalance = [], dataInvested = [];
            labels.push('Start'); dataBalance.push(currentBalance); dataInvested.push(totalInvested);
            for (let i = 1; i <= state.years; i++) {
                for (let m = 0; m < 12; m++) {
                    currentBalance += currentBalance * (profile.rate / 100 / 12) + state.monthly;
                    totalInvested += state.monthly;
                }
                labels.push(`${i}. rok`); dataBalance.push(Math.round(currentBalance)); dataInvested.push(Math.round(totalInvested));
            }
            els.totalBalance.innerText = formatCurrency(Math.round(currentBalance));
            els.totalInvested.innerText = formatCurrency(Math.round(totalInvested)) + " Kč";
            els.totalGain.innerText = "+" + formatCurrency(Math.round(currentBalance - totalInvested)) + " Kč";
            els.totalGainPercent.innerText = "+" + (((currentBalance - totalInvested) / totalInvested) * 100).toFixed(1) + " %";
            updateGrowthChart(labels, dataInvested, dataBalance, profile.color);
            updateAllocationChart(profile);
            updateBacktestChart();
        }

        function updateGrowthChart(labels, invested, balance, color) {
            const ctx = getEls().growthCanvas.getContext('2d');
            if (growthChartInstance) growthChartInstance.destroy();
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, color + '66');
            gradient.addColorStop(1, color + '00');
            growthChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Celková hodnota', data: balance, borderColor: color, backgroundColor: gradient, borderWidth: 3, fill: true, tension: 0.4, pointRadius: 0, pointHoverRadius: 6 },
                        { label: 'Váš vklad', data: invested, borderColor: '#cbd5e1', borderWidth: 2, borderDash: [5, 5], fill: false, tension: 0.4, pointRadius: 0, pointHoverRadius: 6 }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => (c.dataset.label + ': ' + new Intl.NumberFormat('cs-CZ').format(c.parsed.y) + ' Kč') } } }, scales: { y: { beginAtZero: false, grid: { color: '#f1f5f9' }, ticks: { callback: (v) => v >= 1000000 ? (v/1000000).toFixed(1) + 'M' : (v/1000).toFixed(0) + 'k' } }, x: { grid: { display: false }, ticks: { maxTicksLimit: 6 } } } }
            });
        }

        function updateAllocationChart(profile) {
            const els = getEls();
            els.allocationLegend.innerHTML = profile.composition.map(item => `
                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 transition-colors">
                    <div class="flex items-center gap-3">
                        <span class="w-3 h-3 rounded-full shadow-sm" style="background-color: ${item.color}"></span>
                        <span class="font-bold text-slate-700 text-sm">${item.name}</span>
                    </div>
                    <span class="font-bold text-brand-dark">${item.value} %</span>
                </div>`).join('');
            const ctx = els.allocationCanvas.getContext('2d');
            if (allocationChartInstance) allocationChartInstance.destroy();
            allocationChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: profile.composition.map(c => c.name), datasets: [{ data: profile.composition.map(c => c.value), backgroundColor: profile.composition.map(c => c.color), borderWidth: 0, borderRadius: 999, spacing: 3, hoverOffset: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => ` ${c.label}: ${c.parsed}%` } } } }
            });
        }

        function updateBacktestChart() {
            const monthly = state.monthly, startYear = state.startYear, els = getEls();
            if(els.backtestMonthlyLabel) els.backtestMonthlyLabel.innerText = formatCurrency(monthly);
            const targetStartDate = new Date(`${startYear}-01-01`);
            let startIndex = historicalData.findIndex(d => new Date(d.date) >= targetStartDate);
            if (startIndex === -1) startIndex = 0;
            let accInvested = 0, units = { sp500: 0, gold: 0, bonds: 0, re: 0 };
            const series = { invested: [], sp500: [], gold: [], bonds: [], re: [] };
            const getMonthsDiff = (d1, d2) => { let m = (d2.getFullYear() - d1.getFullYear()) * 12; m -= d1.getMonth(); m += d2.getMonth(); return m <= 0 ? 0 : m; };
            for (let i = startIndex; i < historicalData.length; i++) {
                const pt = historicalData[i], currentDate = new Date(pt.date);
                let monthsPassed = i > startIndex ? getMonthsDiff(new Date(historicalData[i-1].date), currentDate) : 1;
                if (monthsPassed < 1) monthsPassed = 1;
                const deposit = monthly * monthsPassed;
                accInvested += deposit;
                units.sp500 += deposit / pt.sp500; units.gold += deposit / pt.gold;
                units.bonds += deposit / pt.bonds; units.re += deposit / pt.re;
                const ts = currentDate.getTime();
                series.invested.push([ts, accInvested]);
                series.sp500.push([ts, Math.round(units.sp500 * pt.sp500)]);
                series.gold.push([ts, Math.round(units.gold * pt.gold)]);
                series.bonds.push([ts, Math.round(units.bonds * pt.bonds)]);
                series.re.push([ts, Math.round(units.re * pt.re)]);
            }
            const options = {
                series: [{ name: 'Vloženo celkem', type: 'area', data: series.invested }, { name: 'S&P 500', type: 'area', data: series.sp500 }, { name: 'Zlato', type: 'line', data: series.gold }, { name: 'Dluhopisy', type: 'line', data: series.bonds }, { name: 'Nemovitostní fondy', type: 'line', data: series.re }],
                chart: { type: 'area', height: 500, fontFamily: 'Inter, sans-serif', toolbar: { show: false }, zoom: { enabled: false }, animations: { enabled: false } },
                colors: ['#E0E0E0', '#2E3A8C', '#F2C94C', '#775DD0', '#00E396'],
                stroke: { curve: 'smooth', width: [0, 2, 2, 2, 2] },
                fill: { type: ['solid', 'gradient', 'solid', 'solid', 'solid'], gradient: { shadeIntensity: 1, opacityFrom: 0.4, opacityTo: 0.05, stops: [0, 100] }, opacity: [0.3, 0.5, 1, 1, 1] },
                dataLabels: { enabled: false }, grid: { borderColor: '#f1f5f9', strokeDashArray: 3, xaxis: { lines: { show: true } } },
                xaxis: { type: 'datetime', tooltip: { enabled: false }, axisBorder: { show: false }, axisTicks: { show: false }, labels: { style: { colors: '#94a3b8' } } },
                yaxis: { labels: { formatter: (val) => val >= 1000000 ? (val / 1000000).toFixed(1) + "M" : (val >= 1000 ? (val / 1000).toFixed(0) + "k" : val), style: { colors: '#94a3b8' } } },
                tooltip: { theme: 'light', shared: true, intersect: false, y: { formatter: (val) => formatCurrency(val) }, x: { formatter: (val) => { const date = new Date(val); return `${CZECH_MONTHS[date.getMonth()]} ${date.getFullYear()}`; } } },
                legend: { position: 'top', horizontalAlign: 'right' }, markers: { size: 0 },
                annotations: { xaxis: [{ x: new Date('2000-03-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Dot-com', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2008-09-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Krize 2008', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2020-03-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'COVID-19', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2022-02-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Válka/Inflace', style: { color: '#fff', background: '#EF4444' } } }] }
            };
            if (backtestChartInstance) { backtestChartInstance.updateOptions({ series: options.series }); }
            else { const chartDiv = document.querySelector("#backtestChart"); if(chartDiv) { backtestChartInstance = new ApexCharts(chartDiv, options); backtestChartInstance.render(); } }
        }

        function openModal() { const els = getEls(); els.modalProfileName.innerText = profiles[state.profileIndex].name; els.modal.classList.remove('hidden'); setTimeout(() => { els.modalBackdrop.classList.remove('opacity-0'); els.modalContent.classList.remove('opacity-0', 'scale-95'); els.modalContent.classList.add('scale-100'); }, 10); }
        function closeModal() { const els = getEls(); els.modalBackdrop.classList.add('opacity-0'); els.modalContent.classList.remove('scale-100'); els.modalContent.classList.add('opacity-0', 'scale-95'); setTimeout(() => els.modal.classList.add('hidden'), 300); }

        document.addEventListener('DOMContentLoaded', () => {
            const els = getEls();
            els.initialRange.addEventListener('input', (e) => updateInputs('initial', parseInt(e.target.value)));
            els.initialInput.addEventListener('change', (e) => updateInputs('initial', parseCurrency(e.target.value)));
            els.monthlyRange.addEventListener('input', (e) => updateInputs('monthly', parseInt(e.target.value)));
            els.monthlyInput.addEventListener('change', (e) => updateInputs('monthly', parseCurrency(e.target.value)));
            els.yearsRange.addEventListener('input', (e) => updateInputs('years', parseInt(e.target.value)));
            els.startYearInput.addEventListener('input', (e) => updateInputs('startYear', parseInt(e.target.value)));
            // Init + live fill for neu sliders
            [els.initialRange, els.monthlyRange, els.yearsRange, els.startYearInput].forEach(r => {
                applyNeuRangeFill(r);
                r.addEventListener('input', () => applyNeuRangeFill(r));
            });
            renderFaq(); switchProfile(1);

            // AJAX Form Submission Logic
            const form = document.getElementById('leadForm');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalBtnContent = submitBtn.innerHTML;
                    
                    // Loading state
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Odesílám...';
                    
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData.entries());
                    
                    // Přidání dalších informací z kalkulačky
                    data._subject = `Poptávka: Investiční plán (${profiles[state.profileIndex].name})`;
                    data.investice_vklad = formatCurrency(state.initial) + ' Kč';
                    data.investice_mesicne = formatCurrency(state.monthly) + ' Kč';
                    data.investice_doba = state.years + ' let';

                    try {
                        const response = await fetch("https://formsubmit.co/ajax/pribramsky@premiumbrokers.cz", {
                            method: "POST",
                            headers: { 
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            },
                            body: JSON.stringify(data)
                        });

                        if (response.ok) {
                            // Success state
                            submitBtn.classList.remove('bg-brand-dark', 'hover:bg-slate-900');
                            submitBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                            submitBtn.innerHTML = '<i class="fas fa-check"></i> Odesláno úspěšně';
                            
                            setTimeout(() => {
                                closeModal();
                                form.reset();
                                // Reset button style after closing
                                setTimeout(() => {
                                    submitBtn.disabled = false;
                                    submitBtn.classList.add('bg-brand-dark', 'hover:bg-slate-900');
                                    submitBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                                    submitBtn.innerHTML = originalBtnContent;
                                }, 500);
                            }, 2000);
                        } else {
                            throw new Error('Chyba při odesílání');
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        submitBtn.classList.remove('bg-brand-dark', 'hover:bg-slate-900');
                        submitBtn.classList.add('bg-red-600', 'hover:bg-red-700');
                        submitBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Chyba, zkuste to znovu';
                        
                        setTimeout(() => {
                            submitBtn.disabled = false;
                            submitBtn.classList.add('bg-brand-dark', 'hover:bg-slate-900');
                            submitBtn.classList.remove('bg-red-600', 'hover:bg-red-700');
                            submitBtn.innerHTML = originalBtnContent;
                        }, 3000);
                    }
                });
            }
        });
    </script>
    <script src="../assets/js/main.js"></script>
</body>
</html>
